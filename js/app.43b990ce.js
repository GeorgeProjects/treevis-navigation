(function(e){function t(t){for(var r,o,s=t[0],l=t[1],d=t[2],u=0,h=[];u<s.length;u++)o=s[u],n[o]&&h.push(n[o][0]),n[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(h.length)h.shift()();return i.push.apply(i,d||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var c=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0364":function(e,t,a){"use strict";var r=a("5831"),n=a.n(r);n.a},"103b":function(e,t,a){},"15d9":function(e,t,a){},"1d5a":function(e,t,a){},"23a7":function(e,t,a){},2464:function(e,t,a){},2766:function(e,t,a){},"52ef":function(e,t,a){},"55a2":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("el-menu",{key:e.componentKey,staticClass:"el-menu-demo",attrs:{mode:"horizontal","background-color":"#676767","text-color":"#fff","default-active":e.activeIndex,"active-text-color":"#ffd04b"}},[a("el-menu-item",{staticClass:"labelIcon",attrs:{id:"title",index:"title"}},[e._v("\n        "+e._s(e.appName)+"\n      ")]),a("el-tooltip",{key:"data",staticClass:"labelIcon",attrs:{content:"data",effect:"light"}},[a("el-menu-item",{attrs:{index:"data"},on:{click:e.handleClickDataIcon}},[a("i",{staticClass:"icon iconfont icon-data"})])],1),a("el-tooltip",{key:"treedsl",staticClass:"labelIcon",attrs:{content:"tree template",effect:"light"}},[a("el-menu-item",{attrs:{index:"treedsl"},on:{click:e.handleClickTemplateIcon}},[a("i",{staticClass:"icon iconfont icon-treedsl"})])],1),a("el-tooltip",{key:"export",staticClass:"labelIcon",attrs:{content:"export",effect:"light"}},[a("el-menu-item",{attrs:{index:"export"},on:{click:function(t){e.exportDialogVisible=!0}}},[a("i",{staticClass:"icon iconfont icon-export"})])],1),a("el-tooltip",{staticClass:"labelIcon",attrs:{effect:"light"}},[a("el-menu-item",{attrs:{id:"login-icon"}},[a("i",{staticClass:"icon iconfont icon-yonghu"}),e._v("\n          GoTree template Index: "+e._s(e.dslNameIndex)+"\n        ")])],1)],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingView,expression:"loadingView"}],staticClass:"content-container"},[e.loadingData?e._e():a("div",{staticClass:"content"},[a("div",{staticClass:"right-panel"},[a("div",{staticClass:"bottom-panel"},[a("div",{attrs:{id:"tree-canvas-view-body"}},[a("div",{attrs:{id:"original-data-view"}},[a("OriginalDataView",{on:{openDataView:e.openDataView,closeDataView:e.closeDataView}})],1),a("div",{attrs:{id:"treecanvas-content-view"}},[a("TreeCanvas",{attrs:{treeCanvasKey:e.treeCanvasKey}})],1)])])])])]),a("el-dialog",{attrs:{title:"Dataset",id:"dataset-dialog",visible:e.dataDialogVisible},on:{"update:visible":function(t){e.dataDialogVisible=t}}},[a("DataDialog",{attrs:{initTreeDataName:e.initTreeDataName,dataDialogKey:e.dataDialogKey},on:{updateSelectedTreeDateName:e.updateSelectedTreeDateName,closeDataDialog:e.closeDataDialog}})],1),a("el-dialog",{attrs:{title:"Tree Template",id:"treedsl-dialog",visible:e.treedslDialogVisible},on:{"update:visible":function(t){e.treedslDialogVisible=t}}},[a("TreedslDialog",{attrs:{treedslDialogUpdate:e.treedslDialogUpdate,updateCurrentTreeDSLIndex:e.updateCurrentTreeDSLIndex}})],1),a("el-dialog",{attrs:{title:"Export",id:"export-dialog","destroy-on-close":!0,visible:e.exportDialogVisible},on:{"update:visible":function(t){e.exportDialogVisible=t}}},[a("ExportDialog")],1)],1)},i=[],o=(a("a481"),a("57e7"),a("cebc")),s=(a("96cf"),a("3b8d")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container",attrs:{id:e.treeCanvasContainerId}},[a("svg",{attrs:{id:e.treeCanvasSvgIdCopy}}),a("svg",{staticClass:"tree-canvas",attrs:{id:e.treeCanvasSvgId}},[a("g",{attrs:{id:e.treeCanvasId}})]),a("div",{attrs:{id:"NodeLabel"}})])},d=[],c=a("768b"),u=(a("7f7f"),a("d25f"),a("c5f6"),a("2f62"));function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0};this.x=e.x,this.y=e.y}h.prototype={init:function(){},updateData:function(){},generatePath:function(e){var t=d3.line().x((function(e){return e.x})).y((function(e){return e.y})),a=t(e);return a}};a("55dd");function f(e,t,a,r,n,i){this.polarAxis=e,this.polarInnerRadius=t,this.polarStartAngle=2*a,this.polarCenterAngle=r,this.polarCenterPara=n,this.polarDirection=i}function p(e,t,a,r,n){var i=[];for(var o in a)i.push(o);i=i.sort((function(e,t){var a=e.replace("index-",""),r=t.replace("index-","");return a-r}));for(var s={},l=0;l<r.length;l++){var d=r[l].data.index;s[d]=r[l]}var c=i[0],u={},h=n.width,f=n.height,p=0,v=0,y=0,m=0,T=0,A=0,D=0,b=0;var S=t[e[c]];u[a[c].id]={fatherID:null,x:p,isLeaf:1,y:y,Rootx:0,Rooty:0,RootWidth:0,RootHeight:0,Width:h,Height:f,depth:0,id:a[c].id,SubtreesX:0,SubtreesY:0,SubtreesWidth:0,SubtreesHeight:0,others:{},value:s[a[c].id].value},g(u[a[c].id],s[a[c].id],S);for(var x=0;x<i.length;x++){var O=i[x],L=u[a[O].id],P=0;0!==a[O].width&&(P=L.Width/a[O].width);var R=0;0!==a[O].height&&(R=L.Height/a[O].height),L.Rootx=a[O].root.x*P+T,L.Rooty=a[O].root.y*R+D,L.RootWidth=a[O].root.width*P-T-A,L.RootHeight=a[O].root.height*R-D-b,L.SubtreesX=a[O].subtrees.x*P+T,L.SubtreesY=a[O].subtrees.y*R+D,L.SubtreesWidth=a[O].subtrees.width*P-T-A,L.SubtreesHeight=a[O].subtrees.height*R-D-b,L.depth,u[a[O].id]=L;for(var E=0;E<a[O].subtreeLayout.length;E++){L.isLeaf=0;var _=a[O].subtreeLayout[E].id;u[_]={fatherID:a[O].id,x:L.x+a[O].subtreeLayout[E].x*P+p,y:L.y+a[O].subtreeLayout[E].y*R+y,Rootx:0,Rooty:0,RootWidth:0,RootHeight:0,isLeaf:1,Width:a[O].subtreeLayout[E].width*P-p-v,Height:a[O].subtreeLayout[E].height*R-y-m,depth:L.depth+1,id:_,SubtreesX:0,SubtreesY:0,SubtreesWidth:0,SubtreesHeight:0,others:{},value:s[_].value},g(u[_],s[_],t[e[_]])}}for(var C in u)u[C].translate="translate(0 , 0)";return u}function g(e,t,a){var r=[];"Tooltip"in a.Element&&(r=a.Element.Tooltip);for(var n=0;n<r.length;n++)e[r[n]]=t.data[r[n]]}f.prototype={updateData:function(e){this.SubTreeData=e,this.initOrigin(),this.initScale()},initScale:function(){var e=this.SubTreeData,t=e.TreeWidth>e.TreeHeight?e.TreeHeight/2:e.TreeWidth/2,a="clockwise"===this.polarDirection?d3.scaleLinear().range([Math.PI*(this.polarCenterAngle+this.polarStartAngle),Math.PI*(-this.polarCenterAngle+this.polarStartAngle)]):d3.scaleLinear().range([Math.PI*(-this.polarCenterAngle+this.polarStartAngle),Math.PI*(this.polarCenterAngle+this.polarStartAngle)]),r=d3.scaleLinear().range([t*this.polarInnerRadius,t]);"y-axis"===this.polarAxis?(a.domain([this.x,this.x+e.TreeWidth]),"top"===this.polarCenterPara?r.domain([this.y,Math.abs(this.y+e.TreeHeight)]):"bottom"===this.polarCenterPara&&r.domain([this.y,Math.abs(this.y-e.TreeHeight)])):"x-axis"===this.polarAxis&&(a.domain([this.y,this.y+e.TreeHeight]),"left"===this.polarCenterPara?r.domain([this.x,Math.abs(this.x+e.TreeWidth)]):"right"===this.polarCenterPara&&r.domain([this.x,Math.abs(this.x-e.TreeWidth)])),this.angleScale=a,this.rScale=r},initOrigin:function(){var e=this._getPolarCenter();this.x=e.x,this.y=e.y},setOrigin:function(e){this.x=e.x,this.y=e.y},generatePath:function(e,t,a){var r=[],n=this.angleScale,i=this.rScale;if("undefined"!==typeof n&&"undefined"!==typeof i||console.log("scale is undefined"),"y-axis"===this.polarAxis)for(var o=0;o<e.length;o++){var s=e[o],l=n(s.x),d=i(s.y),c={angle:l,radius:d};r.push(c)}else if("x-axis"===this.polarAxis)for(var u=0;u<e.length;u++){var h=e[u],f=n(h.y),p=i(h.x),g={angle:f,radius:p};r.push(g)}r=r.sort((function(e,t){return e.radius-t.radius}));var v=r[0].radius,y=r[r.length-1].radius;r=r.sort((function(e,t){return e.angle-t.angle}));var m=r[0].angle,T=r[r.length-1].angle,A=d3.arc().innerRadius((function(e){return v})).outerRadius((function(e){return y})).startAngle((function(e){return m})).endAngle((function(e){return T})).padAngle(.01).padRadius(0);return A()},calPosition:function(e){var t,a=this.angleScale,r=this.rScale;if("y-axis"===this.polarAxis){var n=a(e.x),i=r(e.y);t={angle:n,radius:i}}else if("x-axis"===this.polarAxis){var o=a(e.y),s=r(e.x);t={angle:o,radius:s}}var l=t.angle-Math.PI/2,d=Math.cos(l)*t.radius,c=Math.sin(l)*t.radius,u={x:d,y:c};return u},_getPolarCenter:function(){var e=this.SubTreeData,t=this.polarCenterPara;return"top"===t?{x:e.x+e.TreeWidth/2,y:e.y}:"bottom"===t?{x:e.x+e.TreeWidth/2,y:e.y+e.TreeHeight}:"left"===t?{x:e.x,y:e.y+e.TreeHeight/2}:"right"===t?{x:e.x+e.TreeWidth,y:e.y+e.TreeHeight/2}:void 0}};a("ac6a"),a("f3e2");function v(e){"children"in e?e.children.forEach((function(e){v(e)})):e.children=[]}function y(e){return"Element"in e||(e.Element={}),"CoordinateSystem"in e||(e.CoordinateSystem={}),"Layout"in e||(e.Layout={}),m(e.Element),A(e.Element),T(e.Element),D(e.CoordinateSystem),b(e.Layout),e}function m(e){var t=5,a=["fill","static"],r="#6baed6",n=["#2171b5","#deebf7"],i=["option1","option2"];"Node"in e||(e.Node="hidden"),"SizeOption"in e||(e.SizeOption=a[0]),"RootWidth"in e||(e.RootWidth="adaptive"),"RootHeight"in e||(e.RootHeight="adaptive"),"StaticSize"in e||(e.StaticSize=t),"Color"in e||(e.Color="static"),"StaticColor"in e||(e.StaticColor=r),"ColorRange"in e||(e.ColorRange=n),"ColorSchema"in e||(e.ColorSchema=i[0])}function T(e){var t=0,a=0,r=0;"Label"in e||(e.Label="hidden"),"LabelAnchor"in e||(e.LabelAnchor="middle"),"TextDx"in e||(e.TextDx=t),"LabelDy"in e||(e.TextDy=a),"TextRotation"in e||(e.TextRotation=r)}function A(e){var t=2,a=1,r=10,n=["top","bottom"];"Link"in e||(e.Link="hidden"),"Thickness"in e||(e.Thickness="static"),"StaticThickness"in e||(e.StaticThickness=t),"MinThickness"in e||(e.MinThickness=a),"MaxThickness"in e||(e.MaxThickness=r),"ArcDirection"in e||(e.ArcDirection=n[0])}function D(e){var t=["clockwise","anticlockwise"],a=["y-axis","x-axis"],r="top",n="cartesian",i=1,o=0,s=0;"Category"in e||(e.Category=n),"Direction"in e||(e.Direction=t[0]),"CentralAngle"in e||(e.CentralAngle=i),"StartAngle"in e||(e.StartAngle=o),"InnerRadius"in e||(e.InnerRadius=s),"PolarAxis"in e||(e.PolarAxis=a[0]),"PolarCenter"in e||(e.PolarCenter=r)}function b(e){var t="AxisIndependent",a="bottom-up";"Category"in e||(e.Category=t),"Mode"in e||(e.Mode=a),"X"in e||(e.X={}),"Y"in e||(e.Y={}),S(e),x(e)}function S(e){function t(e,t){var a="Undefined",r=0,n="",i=[0,0],o=["",""],s="left";"Y"===t&&(s="top");var l="middle";"Relation"in e||(e["Relation"]=a),"Alignment"in e||(e["Alignment"]=l),"Position"in e||(e["Position"]=s),"Margin"in e||(e["Margin"]=r),"Padding"in e||(e["Padding"]=i),"Margin_"in e||(e["Margin_"]=n),"Padding_"in e||(e["Padding_"]=o)}"Root"in e["X"]||(e["X"]["Root"]={}),t(e["X"]["Root"],"X"),L(e["X"]["Root"]),O(e["X"]["Root"]),"Root"in e["Y"]||(e["Y"]["Root"]={}),t(e["Y"]["Root"],"Y"),L(e["Y"]["Root"]),O(e["Y"]["Root"])}function x(e){function t(e){var t="Undefined",a="middle",r=0,n="",i="null",o="asc";"Relation"in e||(e["Relation"]=t),"Alignment"in e||(e["Alignment"]=a),"Margin"in e||(e["Margin"]=r),"Margin_"in e||(e["Margin_"]=n),"SortingCriteria"in e||(e["SortingCriteria"]=i),"SortingOrder"in e||(e["SortingOrder"]=o)}"Subtree"in e["X"]||(e["X"]["Subtree"]={}),t(e["X"]["Subtree"]),L(e["X"]["Subtree"]),"Subtree"in e["Y"]||(e["Y"]["Subtree"]={}),t(e["Y"]["Subtree"]),L(e["Y"]["Subtree"])}function O(e){"Padding"in e&&(isNaN(e.Padding[0])&&(e.Padding_=[e.Padding[0].slice(-1),""],e.Padding[0]=+e.Padding[0].slice(0,-1)),isNaN(e.Padding[1])&&(e.Padding_[1]=e.Padding[1].slice(-1),e.Padding[1]=+e.Padding[1].slice(0,-1)))}function L(e){"Margin"in e&&isNaN(e.Margin)&&(e.Margin_=e.Margin.slice(-1),e.Margin=+e.Margin.slice(0,-1))}var P=function(e){for(var t in e){var a=e[t],r=JSON.parse(JSON.stringify(a));if("Element"in r||(r.Element={}),"RootWidth"in r.Element||(r.Element.RootWidth="adaptive"),"RootHeight"in r.Element||(r.Element.RootHeight="adaptive"),"SubtreeWidth"in r.Layout||(r.Layout.SubtreeWidth="adaptive"),"SubtreeHeight"in r.Layout||(r.Layout.SubtreeHeight="adaptive"),"X"in r.Layout||(r.Layout.X={},r.Layout.Y={}),"Subtree"in r.Layout.X){var n=r.Layout.X.Subtree;"Relation"in n&&"Undefined"!==n.Relation||(n.Relation="align"),"Margin_"in n&&(isNaN(n.Margin)||(n.Margin+=n.Margin_)),n=r.Layout.Y.Subtree,"Relation"in n&&"Undefined"!==n.Relation||(n.Relation="align"),"Margin_"in n&&(isNaN(n.Margin)||(n.Margin+=n.Margin_))}else r.Layout.X.Subtree={Relation:"align"},r.Layout.Y.Subtree={Relation:"align"};if("Root"in r.Layout.X){var i=r.Layout.X.Root;"Relation"in i&&"Undefined"!==i.Relation||(i.Relation="include"),"Padding_"in i&&(isNaN(i.Padding[0])||(i.Padding[0]+=i.Padding_[0]),isNaN(i.Padding[1])||(i.Padding[1]+=i.Padding_[1])),"Margin_"in i&&(isNaN(i.Margin)||(i.Margin+=i.Margin_)),i=r.Layout.Y.Root,"Relation"in i&&"Undefined"!==i.Relation||(i.Relation="include"),"Padding_"in i&&(isNaN(i.Padding[0])||(i.Padding[0]+=i.Padding_[0]),isNaN(i.Padding[1])||(i.Padding[1]+=i.Padding_[1])),"Margin_"in i&&(isNaN(i.Margin)||(i.Margin+=i.Margin_))}else r.Layout.X.Root={Relation:"include"},r.Layout.Y.Root={Relation:"include"};"MarginType"in r.Layout.X.Subtree||(r.Layout.X.Subtree.MarginType="space-around"),"MarginType"in r.Layout.Y.Subtree||(r.Layout.Y.Subtree.MarginType="space-around"),e[t]=r}};function R(e){var t=e.index,a={},r=0;e.children.forEach((function(e){var t=R(e);Object.assign(a,t);var n=t[e.index];r=r<n?n:r}));var n=r+1;return a[t]=n,a}function E(e,t){e.height=t[e.index],e.children.forEach((function(e){E(e,t)}))}function _(e){var t=e.index,a={},r=0;e.children.forEach((function(e){var t=_(e);Object.assign(a,t);var n=t[e.index];r=n+r}));var n=0===r?1:r;return a[t]=n,a}function C(e,t){e.width=t[e.index],e.children.forEach((function(e){C(e,t)}))}function w(e,t){var a={};return a[t.index]=e,t.children.forEach((function(t){var r=w(e+1,t);Object.assign(a,r)})),a}function N(e,t,a){e.depth=t[e.index],e.rdepth=a+1-t[e.index],e.children.forEach((function(e){N(e,t,a)}))}function I(e,t,a){var r={},n=e.index,i=n in a?a[n]:a.default,o=t[i];return"AxisIndependent"===o.Layout.Category&&(r[n]={data:e,dsl:o}),e.children.forEach((function(e){Object.assign(r,I(e,t,a))})),r}function j(e,t){var a=["adaptive","height","width","depth","rdepth"],r=0;r=a.indexOf(t.Element.RootWidth);var n=0===r?1:e[t.Element.RootWidth],i=-1===r;r=a.indexOf(t.Element.RootHeight);var o=0===r?1:e[t.Element.RootHeight],s=-1===r;return{width:n,height:o,widthWithValue:i,heightWithValue:s,id:e.index,root:{x:0,y:0,width:n,height:o},subtreeLayout:[],subtrees:{x:0,y:0,width:0,height:0}}}a("6c7b");var U=a("75fc"),M=function(e,t,a,r,n,i){var o=[],s=t.children.length;if("include"===a.Root.Relation){if(o=Array(4*s+16).fill(0),o[4+e]=1,o[0+e]=-1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[4*s+10+e]=1,"Padding"in a.Root){var l=0;isNaN(a.Root.Padding[0])?(l=+a.Root.Padding[0].slice(0,-1),"h"===a.Root.Padding[0].slice(-1)?o[5]=-l:o[4]=-l):(l=+a.Root.Padding[0],o[0+e]=-l)}else o[0+e]=0;if(r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[4*s+14+e]=1,"Padding"in a.Root){var d=0;isNaN(a.Root.Padding[1])?(d=+a.Root.Padding[1].slice(0,-1),"h"===a.Root.Padding[1].slice(-1)?o[5]=-d:o[4]=-d):(d=+a.Root.Padding[1],o[0+e]=-d)}else o[0+e]=0;r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[0+e]=1,o[8+e]=-1,o[4*s+10+e]=-1,o[4*s+14+e]=-1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[2+e]=1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[2+e]=1,o[4*s+10+e]=1,o[6+e]=-1,r.A.push(o),r.B.push(0)}else{var c="adaptive"===n?1:t[n];o=Array(4*s+16).fill(0),o[4+e]=1,r.A.push(o),r.B.push(c)}if("within"===a.Root.Relation){var u=.5;"Alignment"in a.Root&&("left"!==a.Root.Alignment&&"top"!==a.Root.Alignment||(u=0),"right"!==a.Root.Alignment&&"bottom"!==a.Root.Alignment||(u=1)),o=Array(4*s+16).fill(0),o[2+e]=1,o[4+e]=u,o[0+e]=-u,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[6+e]=1,o[8+e]=u,o[0+e]=-u,r.A.push(o),r.B.push(0),"flatten"===a.Subtree.Relation&&(o=Array(4*s+16).fill(0),o[8+e]=1,o[0+e]=-1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[6+e]=1,r.A.push(o),r.B.push(0))}if("juxtapose"===a.Root.Relation){if(o=Array(4*s+16).fill(0),o[4*s+10+e]=1,"Margin"in a.Root){var h=0;isNaN(a.Root.Margin)?(h=+a.Root.Margin.slice(0,-1),"h"===a.Root.Margin.slice(-1)?o[5]=-h:o[4]=-h):(h=+a.Root.Margin,o[0+e]=-h)}else o[0+e]=0;r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[4+e]=1,o[4*s+10+e]=1,o[8+e]=1,o[0+e]=-1,r.A.push(o),r.B.push(0),"Position"in a.Root?"left"===a.Root.Position||"top"===a.Root.Position?(o=Array(4*s+16).fill(0),o[2+e]=1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[6+e]=1,o[8+e]=1,o[0+e]=-1,r.A.push(o),r.B.push(0)):(o=Array(4*s+16).fill(0),o[6+e]=1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[2+e]=1,o[4+e]=1,o[0+e]=-1,r.A.push(o),r.B.push(0)):(o=Array(4*s+16).fill(0),o[2+e]=1,r.A.push(o),r.B.push(0),o=Array(4*s+16).fill(0),o[6+e]=1,o[8+e]=1,o[0+e]=-1,r.A.push(o),r.B.push(0))}if("align"===a.Subtree.Relation){var f=.5;"Alignment"in a.Subtree&&("left"!==a.Subtree.Alignment&&"top"!==a.Subtree.Alignment||(f=0),"right"!==a.Subtree.Alignment&&"bottom"!==a.Subtree.Alignment||(f=1)),t.children.forEach((function(t,a){o=Array(4*s+16).fill(0),o[10+4*a+0+e]=1,o[10+4*a+2+e]=f,o[6+e]=-1,o[8+e]=-f,r.A.push(o),r.B.push(0)}))}else{var p=!0,g=Object(U["a"])(t.children);"SortingOrder"in a.Subtree&&(p="desc"!==a.Subtree.SortingOrder),"SortingCriteria"in a.Subtree&&"null"!==a.Subtree.SortingCriteria&&g.sort((function(e,t){return(e[a.Subtree.SortingCriteria]<t[a.Subtree.SortingCriteria]^p)-.5})),t.children.forEach((function(e,t){e.preOrder=t})),g.forEach((function(t,a){"order"in t?t.order[e]=a:t.order=0===e?[a,0]:[0,a]}));var v=0,y=0;if("Margin"in a.Subtree&&(isNaN(a.Subtree.Margin)?(y=a.Subtree.Margin.slice(0,-1),"w"===a.Subtree.Margin.slice(-1)&&(o=Array(4*s+16).fill(0),o[4*s+12+e]=1,o[4]=-y,r.A.push(o),r.B.push(0),v=1),"h"===a.Subtree.Margin.slice(-1)&&(o=Array(4*s+16).fill(0),o[4*s+12+e]=1,o[5]=-y,r.A.push(o),r.B.push(0),v=1)):y=+a.Subtree.Margin),0===v){if(s>1){o=Array(4*s+16).fill(0);for(var m=0;m<s;m++)o[10+4*m+2+e]=1;o[8+e]=-1+y,r.A.push(o),r.B.push(0)}o=Array(4*s+16).fill(0),o[4*s+12+e]=1,"space-around"===a.Subtree.MarginType?o[8+e]=-y/s:o[8+e]=1===s?0:-y/(s-1),r.A.push(o),r.B.push(0)}if(t.children.forEach((function(t,n){if(0===t.order[e])"space-around"===a.Subtree.MarginType?(o=Array(4*s+16).fill(0),o[10+4*n+e]=1,o[6+e]=-1,o[4*s+12+e]=-.5,r.A.push(o),r.B.push(0)):(o=Array(4*s+16).fill(0),o[10+4*n+e]=1,o[6+e]=-1,r.A.push(o),r.B.push(0));else{o=Array(4*s+16).fill(0),o[10+4*n+0+e]=1;var i=g[t.order[e]-1].preOrder;o[10+4*i+0+e]=-1,o[10+4*i+2+e]=-1,o[4*s+12+e]=-1,r.A.push(o),r.B.push(0)}})),"space-around"===a.Subtree.MarginType){var T=g[s-1].preOrder;o=Array(4*s+16).fill(0),o[10+4*T+0+e]=1,o[10+4*T+2+e]=1,o[4*s+12+e]=.5,o[6+e]=-1,o[8+e]=-1,r.A.push(o),r.B.push(0)}else{var A=g[s-1].preOrder;o=Array(4*s+16).fill(0),o[10+4*A+0+e]=1,o[10+4*A+2+e]=1,o[6+e]=-1,o[8+e]=-1,r.A.push(o),r.B.push(0)}}},k=function(e,t,a){var r=["adaptive","height","width","depth","rdepth"],n=!0,i={A:[],B:[]},o=e.children.length,s=0,l=t.Layout.X;M(s,e,l,i,t.Element.RootWidth,"x"),s=1,l=t.Layout.Y,M(s,e,l,i,t.Element.RootHeight,"y");var d=1,c=1,u=[];if(i.isCompatible={},i.widthWithValue=!1,i.heightWithValue=!1,"top-down"===t.Layout.Mode){var h=1;e.children.forEach((function(e,a){u=Array(4*o+16).fill(0),u[10+4*a+2]=1,i.A.push(u),n=r.indexOf(t.Layout.SubtreeWidth),n<0&&(i.widthWithValue=!0),h="adaptive"===t.Layout.SubtreeWidth?1:e[t.Layout.SubtreeWidth],d=d>h?d:h,i.B.push(h),u=Array(4*o+16).fill(0),u[10+4*a+3]=1,i.A.push(u),h=1,n=r.indexOf(t.Layout.SubtreeHeight),n<0&&(i.heightWithValue=!0),h="adaptive"===t.Layout.SubtreeHeight?1:e[t.Layout.SubtreeHeight],c=c>h?c:h,i.B.push(h)}))}else{var f=!1,p=!1,g=!1,v=!1,y={},m={};if(e.children.forEach((function(e,t){e.index in a?(a[e.index].widthWithValue?(f=!0,y[t]=!0):(g=!0,y[t]=!1),a[e.index].heightWithValue?(p=!0,m[t]=!0):(v=!0,m[t]=!1)):(g=!0,v=!0,y[t]=!1,m[t]=!1)})),f)if(g){var T=0,A=0;e.children.forEach((function(e,t){if(!y[t]){u=Array(4*o+16).fill(0),u[10+4*t+2]=1,i.A.push(u);var r=e.index in a?a[e.index].width:1;T+=r,A+=1,d=d>r?d:r,i.B.push(r)}}));var D=T/A;d=d>D?d:D,e.children.forEach((function(e,t){y[t]&&(i.isCompatible[e.index]=!0,u=Array(4*o+16).fill(0),u[10+4*t+2]=1,i.A.push(u),i.B.push(D))}))}else i.widthWithValue=!0,e.children.forEach((function(e,t){u=Array(4*o+16).fill(0),u[10+4*t+2]=1,i.A.push(u);var r=e.index in a?a[e.index].width:1;d=d>r?d:r,i.B.push(r)}));else e.children.forEach((function(e,t){u=Array(4*o+16).fill(0),u[10+4*t+2]=1,i.A.push(u);var r=e.index in a?a[e.index].width:1;d=d>r?d:r,i.B.push(r)}));if(p)if(v){var b=0,S=0;e.children.forEach((function(e,t){if(!m[t]){u=Array(4*o+16).fill(0),u[10+4*t+3]=1,i.A.push(u);var r=e.index in a?a[e.index].height:1;b+=r,S+=1,c=c>r?c:r,i.B.push(r)}}));var x=b/S;c=c>x?c:x,e.children.forEach((function(e,t){m[t]&&(i.isCompatible[e.index]=!0,u=Array(4*o+16).fill(0),u[10+4*t+3]=1,i.A.push(u),i.B.push(x))}))}else i.heightWithValue=!0,e.children.forEach((function(e,t){u=Array(4*o+16).fill(0),u[10+4*t+3]=1,i.A.push(u);var r=e.index in a?a[e.index].height:1;c=c>r?c:r,i.B.push(r)}));else e.children.forEach((function(e,t){u=Array(4*o+16).fill(0),u[10+4*t+3]=1,i.A.push(u);var r=e.index in a?a[e.index].height:1;c=c>r?c:r,i.B.push(r)}))}if("within"===t.Layout.X.Root.Relation&&"align"===t.Layout.X.Subtree.Relation){var O="adaptive"===t.Element.RootWidth?1:e[t.Element.RootWidth];O=O>d?O:d,u=Array(4*o+16).fill(0),u[0]=1,i.A.push(u),i.B.push(O)}if("within"===t.Layout.Y.Root.Relation&&"align"===t.Layout.Y.Subtree.Relation){var L="adaptive"===t.Element.RootHeight?1:e[t.Element.RootHeight];L=L>c?L:c,u=Array(4*o+16).fill(0),u[1]=1,i.A.push(u),i.B.push(L)}return"align"===t.Layout.X.Subtree.Relation&&(u=Array(4*o+16).fill(0),u[8]=1,i.A.push(u),i.B.push(d)),"align"===t.Layout.Y.Subtree.Relation&&(u=Array(4*o+16).fill(0),u[9]=1,i.A.push(u),i.B.push(c)),i};function V(e,t,a){var r=e.length,n=e[0].length,i=new a.Matrix;i.init(r,n);var o=i.data();e.forEach((function(e,t){e.forEach((function(e,a){o[t+a*r]=e}))}));var s=new a.Matrix;s.init(r,1);var l=s.data();t.forEach((function(e,t){l[t]=e}));var d=new a.Matrix,c=new a.Matrix;a.Matrix.SolveLinearSystem(c,d,i,s);for(var u=c.data(),h=[],f=0;f<u.length;f++)h.push(u[f]);return i.destroy(),s.destroy(),c.destroy(),d.destroy(),h}var W=function(e,t,a,r,n){for(var i=e.length,o=(i-16)/4,s=[],l=0;l<o;l++){var d=t.children[l].index;s.push({x:e[10+4*l+0],y:e[10+4*l+1],width:e[10+4*l+2],height:e[10+4*l+3],id:d,isCompatible:d in n})}var c=t.index,u={width:e[0],height:e[1],widthWithValue:a,heightWithValue:r,root:{x:e[2],y:e[3],width:e[4],height:e[5]},id:c,subtreeLayout:s,subtrees:{x:e[6],y:e[7],width:e[8],height:e[9]}};return u},H=function(e,t,a){var r=e.data,n=e.dsl,i=k(r,n,t),o=V(i.A,i.B,a),s=W(o,r,i.widthWithValue,i.heightWithValue,i.isCompatible);return s};function B(e,t,a,r){var n=t[e];0===n.data.children.length?a[e]=j(n.data,n.dsl):"bottom-up"===n.dsl.Layout.Mode?(n.data.children.forEach((function(e){B(e.index,t,a,r)})),a[e]=H(n,a,r)):(a[e]=H(n,a,r),n.data.children.forEach((function(e){B(e.index,t,a,r)})))}var Y=function(e,t,a,r){v(e),P(t),E(e,R(e)),C(e,_(e)),N(e,w(1,e),e.height);var n=I(e,t,a),i={};return 0!==n.length&&B(e.index,n,i,r),i};function F(e){return G.apply(this,arguments)}function G(){return G=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if((new Date).getTime(),a=t.hierarchicalData,r=t.treeDSLContentObj,n=t.treeIndexWithDSL,"undefined"===typeof a||"undefined"===typeof r||"undefined"===typeof n){e.next=7;break}return i=Y(a,r,n,lscgSolver),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),G.apply(this,arguments)}a("6b54"),a("87b3");function J(e,t){this.x=e.x,this.y=e.y,this.radius=t}function z(e,t,a){this.cx=e.x,this.cy=e.y,this.radiusX=Math.round(t),this.radiusY=Math.round(a)}function X(e,t,a,r,n,i){this.width=a,this.height=r,this.x=e,this.y=t,this.id=n,this.path=i}function K(e,t,a,r,n){this.tx=e,this.ty=t,this.tw=a,this.th=r,this.direction=n}J.prototype={init:function(){},updateData:function(){},generatePath:function(){var e=d3.arc().innerRadius(0).outerRadius(this.radius).startAngle(-Math.PI).endAngle(Math.PI);return e()}},z.prototype={init:function(){},updateData:function(){},generatePath:function(){var e=this.cx,t=this.cy,a=this.radiusX,r=this.radiusY;return"M"+(e-a)+","+t+"a"+a+","+r+" 0 1,0 "+2*a+",0a"+a+","+r+" 0 1,0 "+-2*a+",0"}},X.prototype={init:function(){},updateData:function(){}},K.prototype={getNodePosArray:function(){var e=this.tx,t=this.ty,a=this.tw,r=this.th,n=this.direction,i=[{x:e+a/2,y:t},{x:e,y:t+r},{x:e+a,y:t+r},{x:e+a/2,y:t}];return"bottom"===n?i=[{x:e,y:t},{x:e+a/2,y:t+r},{x:e+a,y:t},{x:e,y:t}]:"left"===n?i=[{x:e+a,y:t},{x:e,y:t+r/2},{x:e+a,y:t+r},{x:e+a,y:t}]:"right"===n&&(i=[{x:e,y:t},{x:e+a,y:t+r/2},{x:e,y:t+r},{x:e,y:t}]),i}};var Q=a("e649");function q(e,t,a){-1!==e.indexOf("NaN")&&console.log("error! The path has errors in translatePath function.");for(var r=Q(e),n="",i=0;i<r.length;i++)if(n+=r[i].code,"M"==r[i].code)n+=r[i].x+t+","+(r[i].y+a);else if("L"==r[i].code)n+=r[i].x+t+","+(r[i].y+a);else if("A"==r[i].code){var o=r[i].largeArc?1:0,s=r[i].sweep?1:0;n+=r[i].rx+","+r[i].ry+","+r[i].xAxisRotation+","+o+","+s+","+(r[i].x+t)+","+(r[i].y+a)}return n}function Z(e,t,a,r,n){var i=t.Node,o=t.SizeOption,s={x:a.x+a.Rootx+a.RootWidth/2,y:a.y+a.Rooty+a.RootHeight/2},l={x:r.x+r.TreeWidth/2,y:r.y+r.TreeHeight/2},d=0,c=a.RootWidth>a.RootHeight?a.RootHeight/2:a.RootWidth/2;if("static"===o&&(c=t.StaticSize),"cartesian"===e.Category){if("rectangle"===i){var u=[{x:a.x+a.Rootx,y:a.y+a.Rooty},{x:a.x+a.Rootx,y:a.y+a.Rooty+a.RootHeight},{x:a.x+a.Rootx+a.RootWidth,y:a.y+a.Rooty+a.RootHeight},{x:a.x+a.Rootx+a.RootWidth,y:a.y+a.Rooty},{x:a.x+a.Rootx,y:a.y+a.Rooty}],p=new h,g=p.generatePath(u);return-1!==g.indexOf("NaN")&&console.log("elementPath",g),g}if("triangle"===i){var v=a.x+a.Rootx,y=a.y+a.Rooty,m=a.RootWidth,T=a.RootHeight,A="top";"undefined"!==typeof t.Direction&&(A=t.Direction);var D=new K(v,y,m,T,A),b=D.getNodePosArray(),S=new h,x=S.generatePath(b);return x}if("circle"===i){var O=new J(s,c);return q(O.generatePath(),s["x"],s["y"])}if("ellipse"===i){var L=a.RootWidth/2,P=a.RootHeight/2,R=new z(s,L,P),E=R.generatePath();return E}if("hidden"===i){var _=new J(s,d),C=q(_.generatePath(),s["x"],s["y"]);return C}}else if("polar"===e.Category){var w="y-axis";"undefined"!==typeof e.PolarAxis&&(w=e.PolarAxis);var N="top";"x-axis"===w&&(N="left"),"undefined"!==typeof e.PolarCenter&&(N=e.PolarCenter);var I=0;"undefined"!==typeof e.InnerRadius&&(I=e.InnerRadius);var j=0;"undefined"!==typeof e.StartAngle&&(j=e.StartAngle);var U=1;"undefined"!==typeof e.CentralAngle&&(U=e.CentralAngle);var M="clockwise";"undefined"!==typeof e.Direction&&(M=e.Direction);var k=new f(w,I,j,U,N,M);if("rectangle"===i){var V=[{x:a.x+a.Rootx,y:a.y+a.Rooty},{x:a.x+a.Rootx,y:a.y+a.Rooty+a.RootHeight},{x:a.x+a.Rootx+a.RootWidth,y:a.y+a.Rooty+a.RootHeight},{x:a.x+a.Rootx+a.RootWidth,y:a.y+a.Rooty},{x:a.x+a.Rootx,y:a.y+a.Rooty}];k.updateData(r);var W=q(k.generatePath(V,r),l["x"],l["y"]);return W}if("circle"===i){"index-0"===a.id?k.updateData(n):k.updateData(r);var H=k.calPosition(s);H["x"]=H["x"]+l["x"],H["y"]=H["y"]+l["y"];var B=new J(s,c),Y=q(B.generatePath(),H["x"],H["y"]);return Y}if("triangle"===i){"index-0"===a.id?k.updateData(n):k.updateData(r);var F=k.calPosition(s);F["x"]=F["x"]+l["x"],F["y"]=F["y"]+l["y"];var G=F["x"]-a.RootWidth/2,$=F["y"]-a.RootHeight/2,X=a.RootWidth,Q=a.RootHeight,Z="top";"undefined"!==typeof t.Direction&&(Z=t.Direction);var ee=new K(G,$,X,Q,Z),te=ee.getNodePosArray(),ae=new h,re=ae.generatePath(te);return re}if("ellipse"===i){"index-0"===a.id?k.updateData(n):k.updateData(r);var ne=k.calPosition(s);ne["x"]=ne["x"]+l["x"],ne["y"]=ne["y"]+l["y"];var ie=a.RootWidth/2,oe=a.RootHeight/2,se=new z(ne,ie,oe),le=se.generatePath();return le}if("hidden"===i){k.updateData(n);var de=k.calPosition(s),ce=new J(s,d);de["x"]=de["x"]+l["x"],de["y"]=de["y"]+l["y"];var ue=q(ce.generatePath(),de["x"],de["y"]);return ue}}}function ee(e,t,a,r,n,i){var o=t.Node,s={x:r.x+r.TreeWidth/2,y:r.y+r.TreeHeight/2};if("cartesian"===e.Category)return i;if("polar"===e.Category){var l="y-axis";"undefined"!==typeof e.PolarAxis&&(l=e.PolarAxis);var d="top";"x-axis"===l&&(d="left"),"undefined"!==typeof e.PolarCenter&&(d=e.PolarCenter);var c=0;"undefined"!==typeof e.InnerRadius&&(c=e.InnerRadius);var u=0;"undefined"!==typeof e.StartAngle&&(u=e.StartAngle);var h=1;"undefined"!==typeof e.CentralAngle&&(h=e.CentralAngle);var p="clockwise";"undefined"!==typeof e.Direction&&(p=e.Direction);var g=new f(l,c,u,h,d,p);g.updateData(r);var v=g.calPosition(i),y=Math.pow(Math.pow(v.x,2)+Math.pow(v.y,2),.5);if("rectangle"===o){g.updateData(r);var m=g.calPosition(i);return m["x"]=m["x"]+s["x"],m["y"]=m["y"]+s["y"],m["r"]=y,m}if("circle"===o||"triangle"===o||"ellipse"===o||"hidden"===o){"index-0"===a.id?g.updateData(n):g.updateData(r);var T=g.calPosition(i);return T["x"]=T["x"]+s["x"],T["y"]=T["y"]+s["y"],T["r"]=y,T}}}function te(e,t,a){var r=null,n=d3.line(),i={x:t.x+t.TreeWidth/2,y:t.y+t.TreeHeight/2};if("cartesian"===e.Category){var o=a.start,s=a.end,l=[];return l.push([o.x,o.y]),l.push([s.x,s.y]),r=n(l),r}if("polar"===e.Category){var d="y-axis";"undefined"!==typeof e.PolarAxis&&(d=e.PolarAxis);var c="top";"x-axis"===d&&(c="left"),"undefined"!==typeof e.PolarCenter&&(c=e.PolarCenter);var u=0;"undefined"!==typeof e.InnerRadius&&(u=e.InnerRadius);var h=0;"undefined"!==typeof e.StartAngle&&(h=e.StartAngle);var p=1;"undefined"!==typeof e.CentralAngle&&(p=e.CentralAngle);var g="clockwise";"undefined"!==typeof e.Direction&&(g=e.Direction);var v=new f(d,u,h,p,c,g);v.updateData(t);v.x,v.y;var y=a.start,m=a.end,T=y.x,A=y.y,D=m.x,b=m.y;y=v.calPosition(y);var S=y.x,x=y.y;m=v.calPosition(m);var O=m.x,L=m.y;if("y-axis"===d){if(T===D){var P=[];return S>O?(P.push([O,L]),P.push([S,x])):(P.push([S,x]),P.push([O,L])),r=q(n(P),i["x"],i["y"]),r}}else if("x-axis"===d&&A===b){var R=[];return S>O?(R.push([O,L]),R.push([S,x])):(R.push([S,x]),R.push([O,L])),r=q(n(R),i["x"],i["y"]),r}var E=0,_=0,C=Math.pow(Math.pow(S-E,2)+Math.pow(x-_,2),.5),w=(Math.pow(Math.pow(O-E,2)+Math.pow(L-_,2),.5),d3.arc().innerRadius(C).outerRadius(C),Math.round(_-x)/C);w=w>1?1:w,w=w<-1?-1:w;var N=Math.asin(w);S<=E||(N=Math.PI-N),isNaN(N)&&console.log("initAngleSin",w);var I=Math.round(_-L)/C;I=I>1?1:I,I=I<-1?-1:I;var j=Math.asin(I);if(O<=E||(j=Math.PI-j),C>.001){var U=!0;"clockwise"===e.Direction&&(U=!1);var M=d3.path();return M.arc(E,_,C,N,j,U),-1!==M.toString().indexOf("NaN")&&console.log("polarOriginX",E,"polarOriginY",_,"radius",C,"initAngle",N,"endAngle",j),r=q(M.toString(),i["x"],i["y"]),r}}}function ae(e,t,a,r,n){var i=[];for(var o in e)i.push(o);i=i.sort((function(e,t){var a=e.replace("index-",""),r=t.replace("index-","");return a-r}));var s=i[0],l=[],d=[];for(var c in e)if(l.push(e[c]),null!=e[c].fatherID){var u={beginid:e[c].fatherID,endid:e[c].id};d.push(u)}var h={};if("undefined"!==typeof n)for(var f=0;f<n.length;f++){var p=n[f],g=p.data.index;h[g]=p.data}for(var v=O(l),y=L(l),m=R(v),T=0;T<l.length;T++){var A=l[T],D=v[T],b=y[T];E(A,D,m,b)}for(var S=0;S<d.length;S++){var x=d[S];x.pathAttr=_(x)}return P(l),[l,d];function O(e){for(var t=[],a=0;a<e.length;a++){var r=e[a],n=r.x+r.Rootx+r.RootWidth/2,i=r.y+r.Rooty+r.RootHeight/2;t.push({x:n,y:i})}return t}function L(e){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.id,s=t[a[o]],l=0,d=0;"TextDx"in s.Element&&(l=s.Element.TextDx),"TextDy"in s.Element&&(d=s.Element.TextDy);var c={};"cartesian"===s.CoordinateSystem.Category?c=i.RootWidth>=i.RootHeight?p(i,d):f(i,l):"polar"===s.CoordinateSystem.Category&&("x-axis"===s.CoordinateSystem.PolarAxis?c=i.RootWidth>=1.5*i.RootHeight?p(i,d):f(i,l):"y-axis"===s.CoordinateSystem.PolarAxis&&(c=i.RootHeight>=1.5*i.RootWidth?f(i,l):p(i,d)));var u={x:c.areaLabelPathStartPosX,y:c.areaLabelPathStartPosY},h={x:c.areaLabelPathEndPosX,y:c.areaLabelPathEndPosY};r.push({start:u,end:h})}return r;function f(e,t){var a={};return a.areaLabelPathStartPosX=e.x+e.Rootx+e.RootWidth/2+t*e.RootWidth,a.areaLabelPathEndPosX=e.x+e.Rootx+e.RootWidth/2+t*e.RootWidth,a.areaLabelPathStartPosY=e.y+e.Rooty,a.areaLabelPathEndPosY=e.y+e.Rooty+e.RootHeight,a}function p(e,t){var a={};return a.areaLabelPathStartPosX=e.x+e.Rootx,a.areaLabelPathEndPosX=e.x+e.Rootx+e.RootWidth,a.areaLabelPathStartPosY=e.y+e.Rooty+e.RootHeight/2+t*e.RootHeight,a.areaLabelPathEndPosY=e.y+e.Rooty+e.RootHeight/2+t*e.RootHeight,a}}function P(e){for(var n=100,i=100,o=2,s=0,l=(r.width>r.height?r.height:r.width,0);l<e.length;l++){var d=e[l],c=d.RootHeight,u=d.RootWidth,f=d.id,p=t[a[f]],g=p.Element.Label,v=0;"TextDx"in p.Element&&(v=p.Element.TextDx);var y=0;if("TextDy"in p.Element&&(y=p.Element.TextDy),"polar"===p.CoordinateSystem.Category&&"pos"in d){var m=d.pos.r;if("x-axis"===p.CoordinateSystem.PolarAxis){u/=2;var T=2*Math.PI*m/r.height;c*=T}else if("y-axis"===p.CoordinateSystem.PolarAxis){c/=2;var A=2*Math.PI*m/r.width;u*=A}}var D=c<u?u:c,b=c>u?u:c;d.RootWidth>=d.RootHeight?d.labelPathPos=50+50*v:d.labelPathPos=50+50*y;var S="";"undefined"!==typeof g&&"hidden"!==g&&null!=g&&"null"!==g&&"undefined"!==typeof h[f]&&g in h[f]&&(S=h[f][g]),d.labelValue=S;var x=b/2>i?i:b/2;x=x>o?x:s,x=x>o?x:s;var O=Math.floor(D/d.labelValue.length),L=Math.floor(b/2),P=O>L?L:O;P=P>s?P:s,P=P>n?n:P,d.fontSize=P+"px",d.rotation=0,"TextRotation"in p.Element&&(d.rotation=180*p.Element.TextRotation),d.textAnchor="middle","TextAnchor"in p.Element&&(d.textAnchor=p.Element.TextAnchor),d.tooltip=[],"Tooltip"in p.Element&&(d.tooltip=p.Element.Tooltip),"rotation"in d||(d.rotation=0)}}function R(e){for(var t={xmin:1e6,ymin:1e6,xmax:0,ymax:0},a=0;a<e.length;a++){var r=e[a],n=r.x,i=r.y;t.xmin>n&&(t.xmin=n),t.xmax<n&&(t.xmax=n),t.ymin>i&&(t.ymin=i),t.ymax<i&&(t.ymax=i)}var o={x:t.xmin,y:t.ymin,TreeWidth:t.xmax-t.xmin,TreeHeight:t.ymax-t.ymin};return o}function E(n,i,o,l){var d=t[a[n.id]].CoordinateSystem.Category,c=r.width/e[s].Width,u=r.height/e[s].Height,f=0,p=0;null!=n.fatherID&&(f=e[s].x,p=e[s].y),"undefined"!==typeof h[n.id]&&(n.data=h[n.id]);var g="";"undefined"!==typeof h[n.id]&&(g=h[n.id].name),n.name=g;var v=0;"undefined"!==typeof h[n.id]&&(v=h[n.id].value),n.value=v;var y=t[a[n.id]].Element,m={id:n.id,x:(e[n.id].x+f)*c,y:(e[n.id].y+p)*u,Rootx:e[n.id].Rootx*c,Rooty:e[n.id].Rooty*u,RootWidth:e[n.id].RootWidth*c,RootHeight:e[n.id].RootHeight*u,isLeaf:e[n.id].isLeaf,Width:e[n.id].Width*c,Height:e[n.id].Height*u,depth:e[n.id].depth};isNaN(m.x)||isNaN(m.RootWidth);var T={};T["TreeWidth"]=r.width,T["TreeHeight"]=self.treeHeight;var A=d,D=n.id,b=t[a[D]].CoordinateSystem;while(1){if("polar"===A&&(T["TreeWidth"]=e[D].Width,T["TreeHeight"]=e[D].Height,T["x"]=e[D].x,T["y"]=e[D].y,b=t[a[D]].CoordinateSystem),D=e[D].fatherID,null===D)break;A=t[a[D]].CoordinateSystem.Category}o["x"]=T["x"],o["TreeWidth"]=T["TreeWidth"];var S=Z(b,y,m,T,o);"undefined"!==typeof S&&(n.element=S);var x=ee(b,y,m,T,o,i);"undefined"!==typeof x&&(n.pos=x);var O=te(b,T,l);"undefined"!==typeof O&&null!=O&&(n.labelPath=O)}function _(r){var n=r.beginid,i=r.endid,o=a[n],s=t[o].Element,l=s.Link;if("hidden"===l||"undefined"===typeof l){var d=a[i],c=t[d].Element;l=c.Link}if("hidden"!==l){var u,h=e[n].pos.x,f=e[n].pos.y,p=e[i].pos.x,g=e[i].pos.y;switch(l){case"straight":var v=[];v.push([h,f]),v.push([p,g]);var y=d3.line();u=y(v);break;case"curveStepX":var m=[];m.push([h,f]),m.push([p,g]);var T=d3.line().curve(d3.curveStep);u=T(m);break;case"orthogonal":var A=[];A.push([h,f]),A.push([h,(f+g)/2]),A.push([p,(f+g)/2]),A.push([p,g]);var D=d3.line();u=D(A);break;case"curveStepAfter":var b=[];b.push([h,f]),b.push([p,g]);var S=d3.line().curve(d3.curveStepAfter);u=S(b);break;case"curveStepBefore":var x=[];x.push([h,f]),x.push([p,g]);var O=d3.line().curve(d3.curveStepBefore);u=O(x);break;case"curve":var L={source:[h,f],target:[p,g]},P=d3.linkVertical();u=P(L);break;case"linkHorizontal":var R={source:[h,f],target:[p,g]},E=d3.linkHorizontal();u=E(R);break;case"arccurve":var _=Math.pow(Math.pow(h-p,2)+Math.pow(f-g,2),.5),C=_/2,w=(h+p)/2,N=(f+g)/2,I=(d3.arc().innerRadius(C).outerRadius(C),Math.round(N-f)/C);I=I>1?1:I,I=I<-1?-1:I;var j=Math.asin(I);if(h<=w||(j=Math.PI-j),C>.001){var U=0+j,M=Math.PI+j,k=!0;if("undefined"!==typeof s.ArcDirection){var V=s.ArcDirection;"bottom"===V&&(k=!1)}var W=d3.path();W.arc(w,N,C,U,M,k),u=W.toString()}break}return"curveStepAfter"!==l&&"curveStepBefore"!==l&&"orthogonal"!==l||console.log("LineData",u),u}}}var re=a("53be"),ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-view-container"},[a("div",{attrs:{id:"original-data-view-title"}},[a("span",{staticClass:"value"},[e._v(e._s(e.selectedDataset))])]),a("div",{attrs:{id:"original-data-view-content"}},[a("div",{attrs:{id:"inner-data-view-content"}},[a("vue-json-pretty",{attrs:{selectableType:"single",data:e.originalTreeData,deep:e.treeDepth,showDoubleQuotes:!1,highlightMouseoverNode:!0,highlightSelectedNode:!0,selectOnClickNode:!0},model:{value:e.selectedArray,callback:function(t){e.selectedArray=t},expression:"selectedArray"}})],1)]),a("div",{attrs:{id:"data-view-toggle"}},[a("el-tooltip",{staticClass:"labelIcon",attrs:{content:e.selectedDataset,effect:"light"}},[a("el-button",{attrs:{plain:""},on:{click:e.toggleDataView}},[a("i",{staticClass:"icon iconfont",class:e.previewPanelOpen?"icon-zuo":"icon-data"})])],1)],1)])},ie=[],oe=a("d538"),se=a.n(oe),le={name:"OriginalDataView",components:{VueJsonPretty:se.a},props:{},data:function(){return{previewPanelOpen:!1,originalTreeData:{},treeDepth:3,selectedArray:[],OPEN_PREVIEW_PANEL_DURATION:1e3}},created:function(){},mounted:function(){this.initTreeData(),this.initToggleButtonPos()},updated:function(){},watch:{selectedDataset:function(){this.originalTreeData=sysDatasetObj.getTreeDataset()}},computed:Object(o["a"])({},Object(u["d"])(["selectedDataset"])),methods:Object(o["a"])({},Object(u["b"])([]),{initTreeData:function(){this.originalTreeData=sysDatasetObj.getTreeDataset()},initToggleButtonPos:function(){var e=$("#data-view-toggle").width();$("#data-view-toggle").height();$("#data-view-toggle").css({right:-e+"px"})},toggleDataView:function(){this.previewPanelOpen?(this.closeDataPanel(),this.$emit("closeDataView")):(this.openDataPanel(),this.$emit("openDataView"))},openDataPanel:function(){if(!this.previewPanelOpen){var e=this.OPEN_PREVIEW_PANEL_DURATION,t=$("#original-data-view").width();$("#original-data-view").animate({left:"+="+t},e,(function(){})),this.previewPanelOpen=!0}},closeDataPanel:function(){if(this.previewPanelOpen){var e=this.OPEN_PREVIEW_PANEL_DURATION,t=$("#original-data-view").width();$("#original-data-view").animate({left:"-="+t},e,(function(){})),this.previewPanelOpen=!1}}})},de=le,ce=(a("a70f"),a("8a8c"),a("2877")),ue=Object(ce["a"])(de,ne,ie,!1,null,"278f3c9f",null),he=ue.exports,fe=(a("6d67"),a("7618"));function pe(e,t,a,r){for(var n=["#2171b5","#deebf7"],i=["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],o=d3.scaleLinear().range(n),s=d3.scaleOrdinal().range(i),l=0;l<e.length;l++){var d=e[l],c=d.id,u=t[a[c]];e[l].node_color=f(d,u,r),e[l].stroke_width=h(d)}return e;function h(e){var t=1.5,a=e.RootWidth,r=e.RootHeight,n=a>r?r:a,i=n/15;return i=i>t?t:i,i+"px"}function f(e,t,a){var r=t.Element.Color;"undefined"===typeof r&&(r="depth");var n=t.Element.ColorSchema,i=t.Element.ColorRange,l=t.Element.StaticColor;"undefined"===typeof l&&(l="#6baed6");var d=m(a),c=e.id,u=d[c].data,h=a[0].data;if("static"===r)return l;var f=Object(fe["a"])(h[r]);if("number"===f){var p=d3.extent(a,(function(e,t){return+e.data[r]}));o.domain(p),"undefined"!==typeof i&&o.range(i);var g=u[r];return o(g)}if("string"===f){"option 1"===n||"option 2"===n&&s.range(d3.schemeSet3);var v=a.map((function(e){return e.data[r]}));s.domain(v);var y=u[r];return s(y)}function m(e){for(var t={},a=0;a<e.length;a++){var r=e[a],n=r.data.index;t[n]=r}return t}}}function ge(e,t,a,r,n,i,o){for(var s=d3.extent(n,(function(e){return e.data.value})),l=Object(c["a"])(s,2),d=(l[0],l[1],d3.scaleLinear()),u=0;u<e.length;u++){var h=e[u],f=h.beginid,p=h.endid,g=t[f],v=t[p],y=a[r[f]],m=a[r[p]];h.link_width=T(g,v,y,m,i,o,n)}return e;function T(e,t,a,r,n,i,o){var s=a.Element.Link,l=r.Element.Link,c=a,u=e;"hidden"===s&&"hidden"!==l&&(c=r,u=t);var h=c.Element.Thickness,f=A(o),p=u.id,g=f[p].data;if("static"===h){if("undefined"===typeof c.Element.StaticThickness){var v=1;return v/2}return c.Element.StaticThickness/2}var y=c.Element.MaxThickness,m=c.Element.MinThickness,T=[y,m],D=d3.extent(o,(function(e,t){return+e.data[h]}));d.domain(D).range(T);var b=g[h];return d(b)/2}function A(e){for(var t={},a=0;a<e.length;a++){var r=e[a],n=r.data.index;t[n]=r}return t}}function ve(e){var t=JSON.parse(JSON.stringify(e));for(var a in t)"Element"in t[a]||(t[a].Element={}),"Node"in t[a].Element||(t[a].Element.Node="rectangle"),"Link"in t[a].Element||(t[a].Element.Link="hidden"),"CoordinateSystem"in t[a]||(t[a].CoordinateSystem={},t[a].CoordinateSystem.Category="cartesian");return t}var ye={name:"TreeCanvas",props:{treeCanvasKey:{type:Number}},data:function(){return{nodeArray:[],hierarchicalData:{},layoutParas:{},treeCanvasSvgId:"tree-dsl-svg-canvas",treeCanvasSvgIdCopy:"tree-dsl-svg-canvas-copy",treeCanvasContainerId:"tree-dsl-canvas-container",treeCanvasId:"tree-dsl-canvas",treeCanvasRectId:"canvas-region-outer-rect",DURATION:500,selectedItem:null,posLenCollectionObj:{},regionOuterRectPos:{},singleTreeG:"tree-g",POSITION_DURATION:400,colorAttr:"depth",treeViewPosLenObj:{},currentRootID:"index-0",treeGId:"index-0-g",previewPanelOpen:!1,hybridNodeObjectNum:10,OPEN_PREVIEW_PANEL_DURATION:250,horizontalArray:[0,.5,1],verticalArray:[0,.5,1],treeViewWidth:0,treeViewHeight:0,viewWidth:0,viewHeight:0,layouts:{},areaDataArray:[],linkDataArray:[]}},components:{OriginalDataView:he},created:function(){},mounted:function(){var e=this;e.adjustTreeCanvas(),e.addZoomFunc()},watch:{treeCanvasKey:function(){this.adjustTreeCanvas(),this.updateTreeVisResults()},assignRecursiveMode:function(){this.highlightFocusedTreeObjIdArray(this.previewTreeObj)},assignNodeQuery:function(){this.highlightFocusedTreeObjIdArray(this.previewTreeObj)},changedDSLNameState:function(){var e=sysDatasetObj.getLayoutParas(),t=e.treeDSLContentObj;"undefined"!==typeof t&&null!=this.treeUnitDSLName&&"undefined"!==typeof t[this.treeUnitDSLName]&&this.updateTreeVisResults()},treeCanvasLayoutState:function(){this.updateTreeVisResults()},currentTreeDSLArray:function(){0===this.currentTreeDSLArray.length&&(d3.select(this.$el).selectAll(".link").remove(),d3.select(this.$el).selectAll(".lineartree-node").remove(),d3.select(this.$el).selectAll(".node-label").remove())}},computed:Object(o["a"])({},Object(u["d"])(["treeDSLArray","assignRecursiveMode","assignNodeQuery","focusedTreeObjArray","changedDSLNameState","treeUnitDSLName","treeCanvasLayoutState","previewTreeObj","currentTreeDSLArray"])),methods:Object(o["a"])({updateTreeVisResults:function(){var e=this,t=sysDatasetObj.getLayoutParas(),a=sysDatasetObj.getNodeArray(),r=o(a,t.treeIndexWithDSL);if(r)F(t).then((function(t){e.layouts=t,e.renderTreeVisResults(t)}));else{var n=sysDatasetObj.getLayoutParas();n.treeIndexWithDSL={};var i=sysDatasetObj.getCurrentTreeDSLArray(this.focusedTreeObjArray);e.UPDATE_CURRENT_TREE_DSL_ARRAY(i),d3.select("#"+this.treeGId).selectAll("*").remove()}function o(e,t){for(var a=[],r=0;r<e.length;r++)a.push(e[r].data.index);var n=[];for(var i in t)n.push(i);return a.length===n.length&&0!==a.length&&0!==n.length}},renderTreeVisResults:function(e){var t=sysDatasetObj.getNodeArray();this.nodeArray=t,this.layoutParas=sysDatasetObj.getLayoutParas(),this.hierarchicalData=this.layoutParas.hierarchicalData;var a=this.layoutParas.treeDSLContentObj;this.dslContentObject=a;var r=this.layoutParas.treeIndexWithDSL;this.treeIndexWithDSL=r;var n=this.treeViewPosLenObj;this.currentRootID;"undefined"!==typeof r&&"undefined"!==typeof a&&null!=e&&"undefined"!==typeof e&&(this.AreaData=p(r,a,e,t,n),this.appendTreeVisBoundingBox(),this.renderTree(),this.adjustTreePos())},negativeExisted:function(e){for(var t in e){var a=e[t].RootHeight,r=e[t].RootWidth;if(r<0||a<0)return!0}return!1},addZoomFunc:function(){var e=this,t=+$("#"+e.treeCanvasSvgId).width(),a=+$("#"+e.treeCanvasSvgId).height(),r=d3.zoom().scaleExtent([.1,40]).translateExtent([[-100,-100],[t+90,a+100]]).on("zoom",n);function n(){d3.select("#"+e.treeCanvasRectId);d3.select("#"+e.treeCanvasId).attr("transform",d3.event.transform)}d3.select("#"+e.treeCanvasSvgId).call(r)},adjustTreePos:function(){var e=this.treeGId,t=this.treeViewPosLenObj;d3.select("#"+e).transition().duration(this.POSITION_DURATION).attr("transform","translate("+t.x+","+t.y+")")},adjustTreeCanvas:function(){var e=this,t=.668;this.viewWidth=$("#"+this.treeCanvasSvgId).width(),this.viewHeight=$("#"+this.treeCanvasSvgId).height();var a=.88*this.viewWidth,r=.88*this.viewHeight;a*t>=r?a=r/t:r=a*t,this.treeWidth=a,this.treeHeight=r,this.viewPaddingTop=(this.viewHeight-this.treeHeight)/2,this.viewPaddingLeft=(this.viewWidth-this.treeWidth)/2;var n={x:this.viewPaddingLeft,y:this.viewPaddingTop,width:this.treeWidth,height:this.treeHeight};d3.select("#"+this.treeCanvasId).select("#"+this.treeCanvasRectId).empty()?d3.select("#"+this.treeCanvasId).append("rect").attr("class","canvas-region-outer").attr("id",this.treeCanvasRectId).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",n.height).on("click",(function(){e.removeControlHighlight()})):d3.select("#"+this.treeCanvasId).select("#"+this.treeCanvasRectId).attr("x",n.x).attr("y",n.y).attr("width",n.width).attr("height",n.height),this.treeViewPaddingTop=0*this.treeHeight,this.treeViewPaddingBottom=0*this.treeHeight,this.treeViewPaddingLeft=0*this.treeWidth,this.treeViewPaddingRight=0*this.treeWidth,this.treeViewWidth=this.treeWidth-this.treeViewPaddingLeft-this.treeViewPaddingRight,this.treeViewHeight=this.treeHeight-this.treeViewPaddingTop-this.treeViewPaddingBottom;var i={x:this.treeViewPaddingLeft+this.viewPaddingLeft,y:this.treeViewPaddingTop+this.viewPaddingTop,width:this.treeViewWidth,height:this.treeViewHeight};this.treeViewPosLenObj=i,e.appendTreeVisBoundingBox(),d3.select("#"+this.treeCanvasId).select("#"+this.treeGId).remove(),d3.select("#"+this.treeCanvasId).append("g").attr("id",this.treeGId).attr("class",this.singleTreeG).attr("transform","translate("+i.x+","+i.y+")")},appendTreeVisBoundingBox:function(){var e=this,t=this.treeGId,a=this.treeViewPosLenObj,r=0*a.width,n=0*a.height,i=t.replace("-g","")+"-bg";d3.select("#"+this.treeCanvasId).select("#"+i).empty()?(d3.select("#"+this.treeCanvasId).append("rect").attr("id",i).attr("class","tree-vis-region-outer").attr("x",a.x-r).attr("y",a.y-n).attr("width",a.width+2*r).attr("height",a.height+2*n).on("click",(function(){e.removePreviewObjectSelection(),e.addControlHighlight();var t=sysDatasetObj.getCurrentTreeDSLArray(e.focusedTreeObjArray);e.UPDATE_CURRENT_TREE_DSL_ARRAY(t)})),e.appendResizeCircle(t)):(d3.select("#"+this.treeCanvasId).select("#"+i).attr("x",a.x-r).attr("y",a.y-n).attr("width",a.width+2*r).attr("height",a.height+2*n),e.repositionResizeCircle(t))},removeControlHighlight:function(){d3.select("#"+this.treeCanvasId).selectAll(".resize-circle-g").classed("highlight",!1),d3.select("#"+this.treeCanvasId).selectAll(".tree-vis-region-outer").classed("highlight",!1)},addControlHighlight:function(){var e=this;d3.select("#"+e.treeCanvasId).select(".resize-circle-g").classed("highlight",!0),d3.select("#"+e.treeCanvasId).select(".tree-vis-region-outer").classed("highlight",!0)},renderGuideline:function(e){var t=e.x,a=e.y,r=e.width,n=e.height;d3.select("#"+this.treeCanvasId).selectAll(".horizontal-mark-line").remove(),d3.select("#"+this.treeCanvasId).selectAll(".horizontal-mark-line").data(this.horizontalArray).enter().append("line").attr("class","horizontal-mark-line mark-line").attr("x1",(function(e,a){return t+e*r})).attr("y1",(function(e,t){return-1e4})).attr("x2",(function(e,a){return t+e*r})).attr("y2",(function(e,t){return 1e4})),d3.select("#"+this.treeCanvasId).selectAll(".vertical-mark-line").remove(),d3.select("#"+this.treeCanvasId).selectAll(".vertical-mark-line").data(this.verticalArray).enter().append("line").attr("class","vertical-mark-line mark-line").attr("x1",(function(e,t){return-1e4})).attr("y1",(function(e,t){return a+e*n})).attr("x2",(function(e,t){return 1e4})).attr("y2",(function(e,t){return a+e*n}))},renderTreeLink:function(e){var t=this,a=t.treeGId,r=d3.select("#"+a).selectAll(".link").data(e.filter((function(e){return"undefined"!==typeof e.pathAttr&&-1===e.pathAttr.indexOf("NaN")})));r.enter().append("path").attr("id",(function(e,t){return"link"+e.beginid+"to"+e.endid})).attr("class",(function(e,t){return"link link-parent-"+e.beginid+" link-child-"+e.endid})).attr("d",(function(e,t){return e.pathAttr})).attr("stroke-width",(function(e,t){return e.link_width})).attr("fill","none");var n=[],i=[],o=[];r.each((function(e,a){var r=d3.select(this).attr("d");null!=r&&"undefined"!==typeof r&&n.push(r);var s=e.pathAttr;null!=s&&"undefined"!==typeof s&&i.push(s),o.push(d3.select(this).node()),d3.select(this).transition().duration(t.DURATION).attr("stroke-width",(function(e,t){return e.link_width})).attr("fill","none")})),r.exit().remove();var s=function(){r.each((function(e,t){d3.select(this).attr("d",e.pathAttr).attr("stroke-width",(function(e,t){return e.link_width}))}))};n.length>0&&i.length>0?n.length===i.length&&null!=n[0]&&null!=i[0]&&"undefined"!==typeof n[0]&&"undefined"!==typeof i[0]&&Object(re["tweenPaths"])({duration:t.DURATION,complete:s,from:n,to:i,next:function(e,t){return o[t].setAttribute("d",e)}}):s()},appendTreeNode:function(e){var t=this,a=(t.nodeArray,t.treeGId),r=(this.layouts,d3.select(this.$el).select("#"+a).selectAll(".lineartree-node-g").data(e,(function(e,t){return e.id})));r.enter().append("g").attr("class","lineartree-node-g").attr("id",(function(e,t){return"nodeg"+e.id})).append("path").attr("class","lineartree-node").attr("id",(function(e,t){return"rootnode"+e.id})).attr("d",(function(e,t){return e.element})).on("mousemove",this.mousemove).on("mouseover",this.mouseover).on("mouseout",this.mouseout).on("click",(function(e,a){var r=JSON.parse(JSON.stringify(e.data));r.fatherID=e.fatherID,t.onclick(r)})).attr("fill",(function(e){return e.node_color})).style("stroke-width",(function(e){return e.stroke_width})).style("opacity",1),d3.select(this.$el).select("#"+a).selectAll(".lineartree-node-g").each((function(e,t){d3.select(this).select(".node-label").empty()&&0!==e.fontSize&&""!==e.labelValue&&(d3.select(this).append("defs").append("path").attr("class","label-curve").attr("id",(function(e){return"curve-"+e.id})).attr("d",(function(e){return e.labelPath})),d3.select(this).append("text").attr("class","node-label").attr("id",(function(e){return"node-label-"+e.id})).append("textPath").attr("xlink:href",(function(e,t){return"#curve-"+e.id})).text((function(e,t){return e.labelValue})).style("text-anchor",(function(e){return e.textAnchor})).attr("transform",(function(e){return"translate(0,0)rotate("+e.rotation+")"})).style("font-size",(function(e){return e.fontSize})).attr("alignment-baseline","middle").attr("startOffset",(function(e,t){return e.labelPathPos+"%"})))}))},renderTreeNode:function(e){var t=this,a=(t.nodeArray,t.treeGId),r=(this.layouts,d3.select(this.$el).select("#"+a).selectAll(".lineartree-node-g").data(e,(function(e,t){return e.id})));r.enter().append("g").attr("class","lineartree-node-g").attr("id",(function(e,t){return"nodeg"+e.id})).append("path").attr("class","lineartree-node").attr("id",(function(e,t){return"rootnode"+e.id})).attr("d",(function(e,t){return e.element})).on("mousemove",this.mousemove).on("mouseover",this.mouseover).on("mouseout",this.mouseout).on("click",(function(e,a){var r=JSON.parse(JSON.stringify(e.data));r.fatherID=e.fatherID,t.onclick(r)})).attr("fill",(function(e){return e.node_color})).style("stroke-width",(function(e){return e.stroke_width})).style("opacity",1),r.each((function(e,t){d3.select(this).select(".node-label").empty()&&0!==e.fontSize&&""!==e.labelValue&&(d3.select(this).append("defs").append("path").attr("class","label-curve").attr("id",(function(e){return"curve-"+e.id})).attr("d",(function(e){return e.labelPath})),d3.select(this).append("text").attr("class","node-label").attr("id",(function(e){return"node-label-"+e.id})).append("textPath").attr("xlink:href",(function(e,t){return"#curve-"+e.id})).text((function(e,t){return e.labelValue})).style("text-anchor",(function(e){return e.textAnchor})).attr("transform",(function(e){return"translate(0,0)rotate("+e.rotation+")"})).style("font-size",(function(e){return e.fontSize})).attr("alignment-baseline","middle").attr("startOffset",(function(e,t){return e.labelPathPos+"%"})))}));var n=[],i=[],o=[];r.each((function(e,a){var r=e.element,s=d3.select(this).select(".lineartree-node").attr("d");o.push(d3.select(this).select(".lineartree-node").node()),n.push(s),i.push(r),d3.select(this).select(".lineartree-node").transition().duration(t.DURATION).attr("fill",(function(e){return e.node_color})).style("stroke-width",(function(e){return e.stroke_width})).style("opacity",1),d3.select(this).transition().duration(t.DURATION).select(".label-curve").attr("d",(function(e){return e.labelPath})),d3.select(this).select(".node-label").select("textPath").transition().duration(t.DURATION).attr("xlink:href",(function(e,t){return"#curve-"+e.id})).style("text-anchor",(function(e){return e.textAnchor})).style("font-size",(function(e){return e.fontSize})).text((function(e,t){return e.labelValue})).attr("transform",(function(e){return"translate(0,0)rotate("+e.rotation+")"})).attr("alignment-baseline","middle").attr("startOffset",(function(e,t){return e.labelPathPos+"%"}))}));var s=function(){r.each((function(e,t){var a=e.element;d3.select(this).select(".lineartree-node").attr("d",a)})),setTimeout((function(){"undefined"!==typeof t.previewTreeObj&&null!=t.previewTreeObj&&t.highlightFocusedTreeObjIdArray(t.previewTreeObj)}),200)};n.length>0&&i.length>0?n.length===i.length&&null!=n[0]&&null!=i[0]&&"undefined"!==typeof n[0]&&"undefined"!==typeof i[0]&&Object(re["tweenPaths"])({duration:t.DURATION,complete:s,from:n,to:i,next:function(e,t){return o[t].setAttribute("d",e)}}):s(),r.exit().remove()},mousemove:function(e){this.treeViewPosLenObj;d3.select("#NodeLabel").style("visibility","visible"),d3.select("#NodeLabel").style("opacity",.9);var t=e.tooltip,a=$("#tree-dsl-canvas-container").offset();function r(e,t){for(var a="<h4>",r=0;r<t.length;r++)a=r===t.length-1?a+t[r]+": "+e[t[r]]:a+t[r]+": "+e[t[r]]+"<br/>";return a+="</h4>",a}t.length>0?(d3.select("#NodeLabel").html(r(e,t)).style("left",d3.event.pageX-a.left+"px").style("top",d3.event.pageY-a.top+"px"),d3.select("#NodeLabel").style("visibility","visible")):d3.select("#NodeLabel").style("visibility","hidden")},mouseover:function(e){},mouseout:function(e){d3.select("#NodeLabel").style("visibility","hidden")},getSelectedTreeUnitRootIdArray:function(e){this.AreaData,this.layouts,this.viewSelectionMode;for(var t=this.assignNodeQuery,a=[],r=this.previewTreeObj[t],n=0;n<this.areaDataArray.length;n++)"fatherID"===t?this.areaDataArray[n][t]===r&&a.push(this.areaDataArray[n]["data"].index):this.areaDataArray[n]["data"][t]===r&&a.push(this.areaDataArray[n]["data"].index);return a},highlightFocusedTreeObjIdArray:function(e){var t=e.index;"A"!==e.name&&(d3.select("#"+this.treeCanvasId).selectAll(".select-root-node").classed("select-root-node",!1),d3.select("#"+this.treeCanvasId).select("#rootnode"+t).classed("select-root-node",!0));var a=this.getSelectedTreeUnitRootIdArray(t),r=this.getFocusedTreeObjIdArray(a);this.UPDATE_FOCUS_TREE_OBJ_ARRAY(r),d3.select("#"+this.treeCanvasId).selectAll(".lineartree-node").classed("clickhighlight",!1).classed("clickunhighlight",!1),d3.select("#"+this.treeCanvasId).selectAll(".lineartree-node").classed("clickunhighlight",!0);for(var n=0;n<r.length;n++)d3.select("#"+this.treeCanvasId).selectAll("#rootnode"+r[n]).classed("clickhighlight",!0).classed("clickunhighlight",!1)},getFocusedTreeObjIdArray:function(e){for(var t=this.assignRecursiveMode,a=this.layouts,r=(this.AreaData,[]),n=0;n<e.length;n++){var i=e[n],o=[];"true"===t?o=l(i):"false"===t&&(o=[i]);for(var s=0;s<o.length;s++)-1===r.indexOf(o[s])&&r.push(o[s])}return r;function l(e){var t=[],r=[e];while(void 0!==e){for(var n=0;n<a[e].subtreeLayout.length;n++){var i=a[e].subtreeLayout[n].id;t.push(i),r.push(i)}e=t.shift()}return r}},unhighlightSelectedNodeArray:function(){d3.select("#"+this.treeCanvasId).selectAll(".lineartree-node").classed("clickunhighlight",!1).classed("clickhighlight",!1).classed("select-root-node",!1)},onclick:function(e){var t=this,a=e.index;t.addControlHighlight(),d3.select("#"+t.treeCanvasId).select("#rootnode"+a).classed("select-root-node")?t.removePreviewObjectSelection():(t.UPDATE_SELECTED_PREVIEW_NODE_ID(a),t.UPDATE_PREVIEW_TREE_OBJ(e),t.highlightFocusedTreeObjIdArray(e));var r=sysDatasetObj.getCurrentTreeDSLArray(this.focusedTreeObjArray);t.UPDATE_CURRENT_TREE_DSL_ARRAY(r)},removePreviewObjectSelection:function(){var e=this;e.UPDATE_SELECTED_PREVIEW_NODE_ID(null),e.unhighlightSelectedNodeArray();var t=sysDatasetObj.getAllTreeObjIdArray();e.UPDATE_FOCUS_TREE_OBJ_ARRAY(t);var a=e.areaDataArray,r=JSON.parse(JSON.stringify(a[0].data));e.UPDATE_PREVIEW_TREE_OBJ(r)},renderTree:function(){var e=this,t=this.treeIndexWithDSL,a=this.dslContentObject,r=this.treeViewPosLenObj,n=(this.layouts,this.AreaData),i=this.nodeArray,o=(this.currentRootID,ve(a)),s=ae(n,o,t,r,i),l=Object(c["a"])(s,2),d=l[0],u=l[1];d=pe(d,o,t,i),u=ge(u,n,o,t,i,this.treeViewWidth,this.treeViewHeight),this.areaDataArray=d,this.linkDataArray=u,e.renderTreeNode(d),e.renderTreeLink(u)},extractDSLContentObject:function(){for(var e=this.treeDSLArray,t={},a=0;a<e.length;a++){var r=e[a],n=r.editorId,i=r.content;t[n]=i}return t},getSvgCoordinates:function(e,t,a){var r=document.getElementById(this.treeCanvasSvgId),n=r.createSVGPoint();n.x=t,n.y=a;var i=n.matrixTransform(e.getScreenCTM().inverse());return i},repositionResizeCircle:function(e){var t=this,a=d3.select("#"+t.treeCanvasId),r=a.select(".resize-circle-g"),n=a.select(".tree-vis-region-outer"),i=+n.attr("x"),o=+n.attr("y"),s=+n.attr("width"),l=+n.attr("height");r.select(".topleft").attr("cx",i).attr("cy",o),r.select(".bottomright").attr("cx",i+s).attr("cy",o+l)},appendResizeCircle:function(e){var t=this,a=d3.select("#"+t.treeCanvasId),r=d3.select("#"+t.treeCanvasId).select(".tree-vis-region-outer"),n=+r.attr("x"),i=+r.attr("y"),o=+r.attr("width"),s=+r.attr("height"),l=a.append("g").attr("class","resize-circle-g");function d(){var a=t.treeViewPosLenObj,r=d3.select(this),n="start"===d3.event.type;if(n||r.classed("hovering")?d3.select("#"+t.treeCanvasId).select(".tree-vis-region-outer").classed("resizing",!0):d3.select("#"+t.treeCanvasId).select(".tree-vis-region-outer.resizing").classed("resizing",!1),n){var i=d3.select("#"+t.treeCanvasId).select(".tree-vis-region-outer"),o=+i.attr("x"),s=+i.attr("y"),l=+i.attr("width"),d=+i.attr("height");t.regionOuterRectPos={x:o,y:s,width:l,height:d}}if(!n){var c=d3.select("#"+t.treeCanvasId).select(".tree-vis-region-outer"),u=+c.attr("x"),h=+c.attr("y"),f=+c.attr("width"),p=+c.attr("height"),g=u-t.regionOuterRectPos.x,v=h-t.regionOuterRectPos.y,y=f-t.regionOuterRectPos.width,m=p-t.regionOuterRectPos.height;a.x=a.x+g,a.y=a.y+v,a.width=a.width+y,a.height=a.height+m;e.replace("-g","");t.updateTreeVisResults()}}l.append("circle").attr("class","topleft").attr("cx",n).attr("cy",i).call(d3.drag().container(d3.select("#"+t.treeCanvasId).node()).subject((function(){return{x:d3.event.x,y:d3.event.y}})).on("start end",d).on("drag",v)),l.append("circle").attr("class","bottomright").attr("cx",n+o).attr("cy",i+s).call(d3.drag().container(d3.select("#"+t.treeCanvasId).node()).subject((function(){return{x:d3.event.x,y:d3.event.y}})).on("start end",d).on("drag",v));var c=t.treeWidth+t.viewPaddingLeft,u=t.viewPaddingLeft,h=t.treeHeight+t.viewPaddingTop,f=t.viewPaddingTop,p=0,g=0;function v(e){var r=t.getSvgCoordinates(a.node(),d3.event.sourceEvent.clientX,d3.event.sourceEvent.clientY),n=Math.max(Math.min(r.x,c),u),i=Math.max(Math.min(r.y,h),f),o=d3.select("#"+t.treeCanvasId).select(".tree-vis-region-outer"),s=+o.attr("x"),l=+o.attr("y"),d=+o.attr("width"),v=+o.attr("height");if(d3.select(this).classed("topleft")){var y=Math.max(d+s-n,p);s+=d-y,d=y;var m=Math.max(v+l-i,g);l+=v-m,v=m,d3.select(this).attr("cx",s).attr("cy",l)}else d=n-s,v=i-l,d3.select(this).attr("cx",s+d).attr("cy",l+v);o.attr("x",s).attr("y",l).attr("width",d).attr("height",v)}}},Object(u["c"])(["UPDATE_TREE_DSL_ARRAY_KEY","UPDATE_FOCUS_TREE_OBJ_ARRAY","UPDATE_PREVIEW_TREE_OBJ","UPDATE_SELECTED_PREVIEW_NODE_ID","UPDATE_CURRENT_TREE_DSL_ARRAY"]))},me=ye,Te=(a("a165"),a("cd36"),a("735c"),a("0364"),Object(ce["a"])(me,l,d,!1,null,"9ce11f3a",null)),Ae=Te.exports,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"data-dialog"}},[a("div",{staticClass:"content-container"},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://127.0.0.1:14452/","http-request":e.getFile,"auto-upload":!0,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.onBeforeUpload,"on-success":e.handleUploadSuccess,"file-list":e.fileList,"show-file-list":!1,multiple:""}},[a("div",{staticClass:"el-upload__text"},[e._v("Drop file here or "),a("em",[e._v("click to upload")])])]),a("span",{staticClass:"inner-label"},[e._v("Your Dateset:")]),a("el-table",{ref:"treeDataTable",staticStyle:{width:"100%"},attrs:{"highlight-current-row":"","default-sort":{prop:"date",order:"descending"},data:e.treeDataArray,"max-height":"170",border:"",stripe:""},on:{"row-dblclick":e.dataTableRowDBClick,"row-click":e.dataTableRowClick}},[a("el-table-column",{attrs:{property:"filename",label:"FileName",sortable:""}}),a("el-table-column",{attrs:{property:"nodenum",label:"NodeNum",sortable:""}}),a("el-table-column",{attrs:{property:"depth",label:"Depth",sortable:"","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[e._v("\n\t\t\t        Delete\n\t\t\t      ")]}},{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",disabled:t.row.username!==e.userInfoName},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[a("span",{staticClass:"icon iconfont icon-iconfontshanchu"})])]}}])})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.closeDataDialog}},[e._v("Cancel")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmSelection}},[e._v("OK")])],1)])},be=[];a("8ea5"),a("28a5");function Se(e,t,a){var r=d3.hierarchy(e),n=[];xe(r,n);for(var i=n.length,o=0,s=0;s<n.length;s++){var l=n[s].depth;l>o&&(o=l)}var d={nodenum:i,depth:o+1,treedata:e,date:(new Date).toISOString().split("T")[0],username:t,filename:a};return d}function xe(e,t){var a=e.children;if(t.push(e),"undefined"!==typeof a)for(var r=0;r<a.length;r++)xe(a[r],t)}var Oe=a("bc3a"),Le=a.n(Oe);function Pe(e,t){console.log("addTreeDataset"),Le()({methods:"get",url:"/dataset/add",params:e,timeout:1e4}).then((function(e){t(e.data)}))}function Re(e,t){Le()({methods:"get",url:"/dataset/remove",params:e,timeout:1e4}).then((function(e){t(e.data)}))}function Ee(e,t){Le()({methods:"get",url:"/template/add",params:e,timeout:1e4}).then((function(e){t(e.data)}))}function _e(e){var t={treename:e.treename,username:e.username,date:e.date};console.log("removeTreeTemplate",t,"templateObj",e),Le()({methods:"get",url:"/template/remove",params:t,timeout:1e4}).then((function(e){console.log("remove the tree template")}))}var Ce={name:"DataDialog",components:{},data:function(){return{search:" ",fileList:[],selectedTreeDataName:null,tempSelection:null,treeDataArray:sysDatasetObj.getTreeDatasetArray()}},watch:{},props:{initTreeDataName:{type:String}},created:function(){},mounted:function(){this.search="",this.selectedTreeDataName=this.initTreeDataName,this.setCurrent()},computed:Object(o["a"])({},Object(u["d"])(["userInfoName"])),methods:{dataTableRowDBClick:function(){},dataTableRowClick:function(e){var t=e.filename;this.tempSelection=t,this.setCurrent(t)},closeDataDialog:function(){this.$emit("closeDataDialog")},confirmSelection:function(){var e=this;if(null!=this.tempSelection){var t=-1!==this.treeDataArray.map((function(e){return e.filename})).indexOf(this.tempSelection);t&&(this.selectedTreeDataName=this.tempSelection,this.updateSelectedTreeDateName(this.selectedTreeDataName),this.tempSelection=null,e.$cookies.set("selected-data-name",this.selectedTreeDataName))}this.$emit("closeDataDialog")},getFile:function(){console.log("upload file ok")},onBeforeUpload:function(e){var t=this,a="application/json"===e.type,r=e.size/1024/1024<2,n=this.getFileNameArray(),i=-1===n.indexOf(e.name);if(a)if(r){if(i){var o=new FileReader;return o.readAsText(e,"utf-8"),o.onload=function(a){var r=JSON.parse(this.result),n=t.userInfoName,i=e.name,o=Se(r,n,i);t.treeDataArray.push(o),"Login"!==t.userInfoName&&(console.log("treeInfoObj",o),Pe(o,t.addDataCallback))},a&&r&&i}this.$message.error("The file name is existed!")}else this.$message.error("The file size can not exceed 2MB!");else this.$message.error("The uploaded file must be JSON format!")},getFileNameArray:function(){for(var e=[],t=0;t<this.treeDataArray.length;t++)e.push(this.treeDataArray[t].filename);return e},handlePreview:function(e){},handleUploadSuccess:function(e,t){console.log("upload success!")},addDataCallback:function(e){this.promptMessage(e.type,e.message)},handleRemove:function(){},handleDelete:function(e,t){this.treeDataArray.splice(e,1);var a={username:t.username,filename:t.filename,depth:t.depth};this.selectedTreeDataName=null,this.tempSelection=null,Re(a,this.removeDataCallback)},removeDataCallback:function(e){this.promptMessage(e.type,e.message)},setCurrent:function(e){for(var t=0;t<this.treeDataArray.length;t++){var a=this.treeDataArray[t];if(a.fileName===e){var r=this.treeDataArray[t];this.$refs.treeDataTable.setCurrentRow(r)}}},updateSelectedTreeDateName:function(e){this.$emit("updateSelectedTreeDateName",e)},promptMessage:function(e,t){this.$message({type:e,message:t})}}},we=Ce,Ne=(a("89e5"),a("7d82"),Object(ce["a"])(we,De,be,!1,null,"1c324c59",null)),Ie=Ne.exports,je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{staticClass:"export-panel",attrs:{gutter:24}},[a("el-col",{attrs:{offset:2,span:20}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"grid-content",attrs:{size:"mini",type:"text"},on:{click:e.save_as_png}},[a("span",[a("i",{staticClass:"icon iconfont icon-png download-icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v("\n              \n             "),a("span",{staticClass:"grid-content-title"},[e._v("Export as PNG")]),a("br"),a("br"),a("span",{staticClass:"grid-content-main"},[e._v("\n               PNG is a bitmap image format which made up of a fixed number of pixels. They have a fixed resolution and cannot be scaled. \n             ")])])])],1),a("el-col",{attrs:{offset:2,span:20}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"grid-content",attrs:{size:"mini",type:"text"},on:{click:e.save_as_svg}},[a("span",[a("i",{staticClass:"icon iconfont icon-svg download-icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v("\n              \n             "),a("span",{staticClass:"grid-content-title"},[e._v("Export as SVG")]),a("br"),a("br"),a("span",{staticClass:"grid-content-main"},[e._v("\n               SVG is a vector image format which uses geometric forms to represent differet parts as discrete objects and are infinitely scalable. \n             ")])])])],1),a("el-col",{attrs:{offset:2,span:20}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"grid-content",attrs:{size:"mini",type:"text"},on:{click:e.save_as_json}},[a("span",[a("i",{staticClass:"icon iconfont icon-format1 download-icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v("\n              \n             "),a("span",{staticClass:"grid-content-title"},[e._v("Export as JSON")]),a("br"),a("br"),a("span",{staticClass:"grid-content-main"},[e._v("\n               JSON is a lightweight data-interchange format. This serves as the visualization template. \n             ")])])])],1)],1)},Ue=[],Me=a("bc05"),ke=a.n(Me),Ve=a("2a68"),We=a.n(Ve),He=function(e){var t=JSON.parse(JSON.stringify(e));if("Layout"in t){if("X"in t.Layout){if("Root"in t.Layout.X){var a=t.Layout.X.Root;"include"===a.Relation&&("Padding"in a&&(console.log(a.Padding[0],a.Padding[1]),"0"===a.Padding[0]&&"0"===a.Padding[1]&&delete a.Padding),delete a.Padding_,delete a.Margin,delete a.Margin_,delete a.Position,delete a.Alignment),"juxtapose"===a.Relation&&(delete a.Padding,delete a.Padding_,"Margin"in a&&"0"===a.Margin&&delete a.Margin,delete a.Margin_,"left"===a.Position&&delete a.Position,delete a.Alignment),"within"===a.Relation&&(delete a.Padding,delete a.Padding_,delete a.Margin,delete a.Margin_,delete a.Position,"middle"===a.Alignment&&delete a.Alignment)}if("Subtree"in t.Layout.X){var r=t.Layout.X.Subtree;"flatten"===r.Relation&&(delete r.Alignment,"Margin"in r&&"0"===r.Margin&&delete r.Margin,delete r.Margin_,"asc"===r.SortingOrder&&delete r.SortingOrder,"null"===r.SortingCriteria&&delete r.SortingCriteria,"space-around"===r.MarginType&&delete r.MarginType),"align"===r.Relation&&("middle"===r.Alignment&&delete r.Alignment,delete r.Margin,delete r.Margin_,delete r.SortingOrder,delete r.SortingCriteria,delete r.MarginType)}}if("Y"in t.Layout){if("Root"in t.Layout.Y){var n=t.Layout.Y.Root;"include"===n.Relation&&("Padding"in n&&"0"===n.Padding[0]&&"0"===n.Padding[1]&&delete n.Padding,delete n.Padding_,delete n.Margin,delete n.Margin_,delete n.Position,delete n.Alignment),"juxtapose"===n.Relation&&(delete n.Padding,delete n.Padding_,"Margin"in n&&"0"===n.Margin&&delete n.Margin,delete n.Margin_,"top"===n.Position&&delete n.Position,delete n.Alignment),"within"===n.Relation&&(delete n.Padding,delete n.Padding_,delete n.Margin,delete n.Margin_,delete n.Position,"middle"===n.Alignment&&delete n.Alignment)}if("Subtree"in t.Layout.Y){var i=t.Layout.Y.Subtree;"flatten"===i.Relation&&(delete i.Alignment,"Margin"in i&&"0"===i.Margin&&delete i.Margin,delete i.Margin_,"asc"===i.SortingOrder&&delete i.SortingOrder,"null"===i.SortingCriteria&&delete i.SortingCriteria,"space-around"===i.MarginType&&delete i.MarginType),"align"===i.Relation&&("middle"===i.Alignment&&delete i.Alignment,delete i.Margin,delete i.Margin_,delete i.MarginType,delete i.SortingOrder,delete i.SortingCriteria)}}}if("Element"in t){var o=t.Element;"Node"in o&&("circle"!==o.Node?(delete o.SizeOption,delete o.StaticSize):"fill"===o.SizeOption&&(delete o.StaticSize,delete o.SizeOption),"adaptive"===o.RootWidth&&delete o.RootWidth,"adaptive"===o.RootHeight&&delete o.RootHeight,"triangle"!==o.Node?delete o.Direction:"top"===o.Direction&&delete o.Direction,"#6baed6"===o.StaticColor&&delete o.StaticColor,"option 1"===o.ColorSchema&&delete o.ColorSchema,"ColorRange"in o&&"#2171b5"===o.ColorRange[0]&&"#deebf7"===o.ColorRange[1]&&delete o.ColorRange,"default"===o.ColorType&&("#6baed6"===o.StaticColor&&delete o.StaticColor,delete o.ColorRange,delete o.ColorSchema),"string"===o.ColorType&&(delete o.StaticColor,delete o.ColorRange,"option 1"===o.ColorSchema&&delete o.ColorSchema),"number"===o.ColorType&&(delete o.StaticColor,delete o.ColorSchema,"undefined"!==typeof o.ColorRange&&"#2171b5"===o.ColorRange[0]&&"#deebf7"===o.ColorRange[1]&&delete o.ColorRange),delete o.ColorType,"height"===o.Color&&delete o.Color,"Label"in o&&"hidden"===o.Label&&(delete o.TextAnchor,delete o.TextDx,delete o.TextDy,delete o.TextRotation,delete o.Label)),"Link"in o&&("arccurve"!==o.Link&&delete o.ArcDirection,"static"===o.Thickness?(delete o.MinThickness,delete o.MaxThickness):delete o.StaticThickness)}if("CoordinateSystem"in t){var s=t.CoordinateSystem;"Category"in s&&("cartesian"===s.Category&&(delete s.StartAngle,delete s.CentralAngle,delete s.PolarCenter,delete s.InnerRadius,delete s.Direction,delete s.PolarAxis),"polar"===s.Category&&(1===s.CentralAngle&&delete s.CentralAngle,"clockwise"===s.Direction&&delete s.Direction,"y-axis"===s.PolarAxis&&delete s.PolarAxis,0===s.InnerRadius&&delete s.InnerRadius,"top"===s.PolarCenter&&delete s.PolarCenter,0===s.StartAngle&&delete s.StartAngle))}return t},Be={name:"ExportDialog",components:{},data:function(){return{appName:"gotree"}},created:function(){},mounted:function(){},computed:Object(o["a"])({},Object(u["d"])(["layoutParas","selectedDataset","focusedTreeObjArray"])),methods:{save_as_png:function(){var e=this.getDownloadFileName(),t="tree-dsl-svg-canvas",a="tree-dsl-canvas",r=d3.select(document.getElementById(t)),n=r.select("#"+a);n.selectAll(".mark-line").attr("display","none"),n.select(".tree-g").selectAll(".resize-circle-g").attr("display","none"),ke.a.saveSvgAsPng(r.node(),e).then((function(){n.selectAll(".mark-line").attr("display",null),n.select(".tree-g").selectAll(".resize-circle-g").attr("display",null)}))},save_as_svg:function(){var e={filename:this.getDownloadFileName()};$("#tree-dsl-svg-canvas #index-0-g").clone().appendTo($("#tree-dsl-svg-canvas-copy")),We.a.save(d3.select("#tree-dsl-svg-canvas-copy").node(),e),setTimeout((function(){$("#tree-dsl-svg-canvas-copy #index-0-g").remove()}),1e3)},save_as_json:function(){var e=sysDatasetObj.getLayoutParas(),t=e.treeDSLContentObj;for(var a in t){var r=t[a],n=He(r),i="GoTree-template-"+a+".json";o(n,i,"text/json")}function o(e,t,a){var r=JSON.stringify(e),n=document.createElement("a"),i=new Blob([r],{type:a});n.href=URL.createObjectURL(i),n.download=t,n.click()}},getDownloadFileName:function(){var e=this.getCurrentDSLName(),t=this.selectedDataset.replace(".json","");return"GoTree-"+t+e},getCurrentDSLName:function(){var e=[],t=sysDatasetObj.getLayoutParas(),a=this.focusedTreeObjArray,r=t.treeIndexWithDSL;for(var n in r)if(-1!==a.indexOf(n)){var i=r[n];-1===e.indexOf(i)&&e.push(i)}var o="";this.currentTreeDSLArray=e;for(var s=0;s<e.length;s++)o=o+"-"+e[s];return o}}},Ye=Be,Fe=(a("71b4"),Object(ce["a"])(Ye,je,Ue,!1,null,null,null)),Ge=Fe.exports,Je=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"dsl-dialog"}},[a("div",{staticClass:"content-container"},[a("div",{staticClass:"inner-title first-title"},[e._v("System Library")]),a("div",{staticClass:"tree-collection"},e._l(e.systemTreeTemplateArray,(function(t,r){return a("div",{staticClass:"example"},[a("div",{staticClass:"preview"},[a("SinglePreviewFigure",{key:t.treename,attrs:{dslId:t.treename,getTreeDSLObj:e.getTreeDSLObj,operation:"root"===e.userInfoName?e.rootSystemTemplateOperation:e.systemTemplateOperation,add2DSLList:e.selectTreeDSL,defaultOperationFunc:e.selectTreeDSL}})],1)])})),0),a("div",{staticClass:"inner-title"},[e._v("Your Templates")]),a("div",{staticClass:"tree-collection"},[a("div",{staticClass:"upload",on:{click:function(t){e.addNewTreeDSL()}}},[a("div",{staticClass:"preview"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","show-file-list":!1,"http-request":e.getFile,"on-success":e.handleTemplateSuccess,"before-upload":e.beforeTemplateUpload}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),e._l(e.userTreeTemplateArray,(function(t,r){return a("div",{staticClass:"example"},[a("div",{staticClass:"preview"},[a("SinglePreviewFigure",{key:t.treename,attrs:{dslId:t.treename,getTreeDSLObj:e.getTreeDSLObj,operation:e.userTemplateOperation,defaultOperationFunc:e.selectTreeDSL,add2DSLList:e.selectTreeDSL}})],1)])}))],2),a("el-dialog",{attrs:{width:"30%",title:"GoTree Template Name",visible:e.templateNameDialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.templateNameDialogVisible=t}}},[a("div",{attrs:{id:"dsl-name-hint"}},[e._v("Please input the name of the import template:")]),a("el-input",{attrs:{placeholder:"GoTreeExample1",autofocus:!1},on:{input:e.changeGoTreeName},model:{value:e.realTemplateName,callback:function(t){e.realTemplateName=t},expression:"realTemplateName"}}),a("div",{staticClass:"template-name-warning-hint"},[e._v(e._s(e.templateNameWarningHint))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelImportDSLTemplate}},[e._v("Cancel")]),a("el-button",{attrs:{disabled:-1!==e.selectedDSLArray.indexOf(e.realTemplateName),type:"primary"},on:{click:e.confirmImportDSLTemplate}},[e._v("Confirm")])],1)],1)],1)])},$e=[];a("ac4d"),a("8a81"),a("20d6");function ze(){var e={treeDataArray:[{fileName:"flare.json",nodeNum:100,depth:5},{fileName:"flare-vis.json",nodeNum:100,depth:5},{fileName:"tmp50.json",nodeNum:120,depth:3},{fileName:"binaryTree.json",nodeNum:120,depth:3}],initTreeDataName:"flare-vis.json",defaultLinkWidth:5,defaultMaxLinkWidth:30,cartesianDSLArray:["ArcTree","BCTh","BCTw","BeamTree","BeamTreeV","CurveTree","GoTree1","GoTree3","IciclePlot","IPTP","NodeLink","NodeLink1","PedVis","Dendrogram","TreemapSlice","TreemapSliceDice"],polarDSLArray:["GoTree2","Sunburst1","Sunburst"],selectedDSLArray:["ArcTree","CurveTree","NodeLink","Sunburst"]};return e}var Xe,Ke=a("bd86");function Qe(){this.originalTreeDataStr=null,this.originalTreeData=null,this.nodeArrayWithValue=null,this.selectedDSLObject={},this.allTreeObjIdArray=[],this.layoutParas={},this.attrObjArray={},this.originalTreeUnitData=null,this.originalTreeUnitDataStr=null,this.treeUnitNodeArrayWithValue=null,this.allTreeDatasetArray=[],this.allTreeTemplateArray=[]}function qe(e,t){return Ze.apply(this,arguments)}function Ze(){return Ze=Object(s["a"])(regeneratorRuntime.mark((function e(t,a){var r,n,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:"undefined"===typeof a&&(a=""),r={},n=0;case 3:if(!(n<t.length)){e.next=13;break}return i=t[n],o=i+".json",e.next=8,d3.json("treeDSL/"+a+o);case 8:s=e.sent,r[i]=s;case 10:n++,e.next=3;break;case 13:return e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}Qe.prototype=(Xe={init:function(){},updateDataset:function(e){var t=this.getOriginalTreeData(e);if("undefined"!==typeof t){this.originalTreeDataStr=t;var a={};try{a="string"===typeof t?JSON.parse(t):t}catch(r){console.log("catch JSON parse error in function updateDataset")}this.addNodexIndex(a),this.originalTreeData=a,this.nodeArrayWithValue=this.computeNodeArray(a),this.allTreeObjIdArray=this.computeTreeObjIdArray(this.nodeArrayWithValue),this.nodeArrayWithValueObj=this.computeNodeArrayWithValueObj(),this.layoutParas.hierarchicalData=a}},computeNodeArrayWithValueObj:function(){for(var e=this.nodeArrayWithValue,t={},a=0;a<e.length;a++)t[e[a].data.index]=e[a].data,t[e[a].data.index]["depth"]=e[a]["depth"],t[e[a].data.index]["height"]=e[a]["height"];return t},getNodeArrayWithValueObj:function(){return this.nodeArrayWithValueObj},findSelectedObjectById:function(e){var t=this.originalTreeData,a=r(t,e);return a;function r(e,t){if(e.index===t)return e;if("undefined"!==typeof e.children)for(var a=null,n=0;n<e.children.length;n++)if(a=r(e.children[n],t),null!=a&&"undefined"!==typeof a)return a}},computeTreeObjIdArray:function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].data.index);return t},getAllTreeObjIdArray:function(){return this.allTreeObjIdArray},updateTreeUnitDataset:function(e){this.originalTreeUnitDataStr=JSON.stringify(e),this.addNodexIndex(e),this.originalTreeUnitData=e,this.treeUnitNodeArrayWithValue=this.computeNodeArray(e)},getTreeDataset:function(){var e=this,t={};try{"string"===typeof e.originalTreeDataStr&&(console.log("parse funtion"),t=JSON.parse(e.originalTreeDataStr))}catch(a){console.log("catch JSON parse error in function getTreeDataset")}return"object"===Object(fe["a"])(e.originalTreeDataStr)&&(t=e.originalTreeDataStr),t},getTreeUnitDataset:function(){return this.originalTreeUnitData},getTreeDSLObject:function(e){return this.selectedDSLObject[e]},getNodeArray:function(){return this.nodeArrayWithValue},getTreeUnitNodeArray:function(){return this.treeUnitNodeArrayWithValue},updateLayoutParas:function(e){this.layoutParas=e},getLayoutParas:function(){return this.layoutParas},updateTreeUnitLayoutParas:function(e){this.treeUnitLayoutParas=e},getTreeUnitLayoutParas:function(){return this.treeUnitLayoutParas},computeNodeArray:function(e){var t=d3.hierarchy(e),a=[];return this.computeValue(t,a),a},addNodexIndex:function(e){var t=[],a=0;t.push(e);while(0!==t.length){var r=t.shift();if("undefined"!==typeof r&&null!=r&&(r.index="index-"+a,a+=1,void 0!==r.children))for(var n=0;n<r.children.length;n++)t.push(r.children[n])}},computeValue:function(e,t){var a=e.children;if(t.push(e),"undefined"!==typeof a){for(var r=0,n=0;n<a.length;n++)this.computeValue(a[n],t),r+=a[n].data.value;"undefined"===typeof e.data.value&&(e.data.value=r)}},addTopDownIndex:function(e){var t=[],a=0;t.push(e);while(0!==t.length){var r=t.shift();if(r.topDownNodeIndex=a,a+=1,void 0!==r.children)for(var n=0;n<r.children.length;n++)t.push(r.children[n])}},addBottomUpIndex:function(e){var t=0;function a(e){var r=e.children;if("undefined"!==typeof r)for(var n=0;n<r.length;n++)a(r[n]);e.bottomUpNodeIndex=t,t+=1}a(e)},updateSingleSelectedDSLObject:function(e,t){this.selectedDSLObject[e]=t},initSelectedDSLObject:function(e){for(var t=this,a=[],r=0;r<t.allTreeTemplateArray.length;r++){var n=t.allTreeTemplateArray[r].treename,i=null;try{i=JSON.parse(JSON.stringify(t.allTreeTemplateArray[r].template))}catch(o){console.log("catch JSON parse error in function initSelectedDSLObject")}null!=i&&-1!==e.indexOf(n)&&(t.selectedDSLObject[n]=i,a.push(n))}return a},updateSelectedDSLObject:function(e,t){this.selectedDSLObject[e]=t},updateTreeDSLContentObject:function(e,t){var a=this.layoutParas.treeDSLContentObj;"undefined"!==typeof a&&"undefined"!==typeof a[e]&&(a[e]=t)},getAllSelectedDSLObject:function(){return this.selectedDSLObject},getSelectedDSLObject:function(e){return this.selectedDSLObject[e]},isDSLObjectExist:function(e){return"undefined"!==typeof this.selectedDSLObject[e]},extractAttrArray:function(){var e=this.originalTreeData,t=[{attrName:"height",attrType:"number"},{attrName:"width",attrType:"number"},{attrName:"rdepth",attrType:"number"},{attrName:"depth",attrType:"number"},{attrName:"index",attrType:"string"}];for(var a in e)if("children"!==a&&"index"!==a){var r=e[a],n=Object(fe["a"])(r);-1===t.map((function(e){return e.attrName})).indexOf(a)&&t.push({attrName:a,attrType:n})}return t},getOriginalTreeData:function(e){for(var t=0;t<this.allTreeDatasetArray.length;t++)if(this.allTreeDatasetArray[t].filename===e)return this.allTreeDatasetArray[t].treedata},getOriginalTreeTemplate:function(e){for(var t=this,a=0;a<t.allTreeTemplateArray.length;a++)if(t.allTreeTemplateArray[a].treename===e){var r={};try{r=JSON.parse(JSON.stringify(t.allTreeTemplateArray[a].template))}catch(n){console.log("catch JSON parse error in function getOriginalTreeTemplate")}return r}},removeOriginalTreeTemplate:function(e){for(var t=0;t<this.allTreeTemplateArray.length;t++)if(this.allTreeTemplateArray[t].treename===e){var a=this.allTreeTemplateArray.splice(t,1);return a[0]}return null},getTreeDatasetArray:function(){return this.allTreeDatasetArray},getTreeTemplateArray:function(){return this.allTreeTemplateArray},getUserTreeTemplateArray:function(){for(var e=this.allTreeTemplateArray.filter((function(e){return"root"!==e.username})),t=[],a=0;a<e.length;a++)try{t.push(JSON.parse(JSON.stringify(e[a])))}catch(r){console.log("catch JSON parse error in function getUserTreeTemplateArray")}return t},getSystemTreeTemplateArray:function(){for(var e=this.allTreeTemplateArray.filter((function(e){return"root"===e.username})),t=[],a=0;a<e.length;a++)try{t.push(JSON.parse(JSON.stringify(e[a])))}catch(r){console.log("catch JSON parse error in function getSystemTreeTemplateArray")}return t},addTreeTemplateArray:function(e){for(var t=this,a=function(a){var r={};try{r="string"===typeof e[a].template?JSON.parse(e[a].template):JSON.parse(JSON.stringify(e[a].template))}catch(o){console.log("catch JSON parse error in function addTreeTemplateArray")}e[a].template=r,y(e[a].template);var n=e[a],i=t.allTreeTemplateArray.findIndex((function(e){return e.treename===n.treename}));-1===i?t.allTreeTemplateArray.push(n):console.log("treeTemplateObj.treename",n.treename)},r=0;r<e.length;r++)a(r)},addTreeDatasetArray:function(e){for(var t=this,a=function(a){var r=e[a],n=t.allTreeDatasetArray.findIndex((function(e){return e.filename===r.filename}));-1===n&&t.allTreeDatasetArray.push(e[a])},r=0;r<e.length;r++)a(r)},addTreeDataset:function(e){var t=this.allTreeDatasetArray.findIndex((function(t){return t.filename===e.filename}));-1===t&&this.allTreeDatasetArray.push(e)},isTemplateExisted:function(e){for(var t=0;t<this.allTreeTemplateArray.length;t++)if(this.allTreeTemplateArray[t].treename===e)return!0;return!1},removeAllUserTemplate:function(){for(var e=0;e<this.allTreeTemplateArray.length;e++)"root"!==this.allTreeTemplateArray[e].username&&(this.allTreeTemplateArray.splice(e,1),e-=1)},removeAllUserDataset:function(){for(var e=0;e<this.allTreeDatasetArray.length;e++)"root"!==this.allTreeDatasetArray[e].username&&(this.allTreeDatasetArray.splice(e,1),e-=1)},getCurrentTreeDSLArray:function(e){var t=[],a=this.getLayoutParas(),r=a.treeIndexWithDSL;for(var n in r)if(-1!==e.indexOf(n)){var i=r[n];-1===t.indexOf(i)&&t.push(i)}return t}},Object(Ke["a"])(Xe,"updateLayoutParas",(function(e,t){var a=this.getLayoutParas();"undefined"===typeof a.treeIndexWithDSL&&(a.treeIndexWithDSL={});for(var r=a.treeIndexWithDSL,n=0;n<e.length;n++){var i=e[n];r[i]=t}var o={};for(var s in r){var l=r[s];o[l]=this.getTreeDSLObject(l)}a.treeDSLContentObj=o})),Object(Ke["a"])(Xe,"updateTreeUnitDSLArray",(function(e,t){var a=this.getLayoutParas(),r=[];try{r=JSON.parse(JSON.stringify(t))}catch(s){console.log("catch JSON parse error in function updateTreeUnitDSLArray")}for(var n=a.treeDSLContentObj,i=function(t){var a=e[t];if(0===r.filter((function(e){return e.name===a})).length){var i=!1;self.treeUnitDSLName===a&&(i=!0),r.push({name:a,dslObj:n[a],visible:i})}},o=0;o<e.length;o++)i(o);return r})),Xe);var et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"dslPreviewContainer",staticClass:"single-preview-figure-container",on:{mouseover:e.parentMouseover,mouseout:e.parentMouseout,click:e.parentClick}},[a("div",{staticClass:"dsl-figure"},[a("svg",{ref:"dslPreviewCanvas",staticClass:"dsl-preview-canvas"},[a("g",{staticClass:"tree-preview-g",attrs:{id:e.treeGId}})])]),a("div",{staticClass:"dsl-name"},[e._v(e._s(e.dslId))]),a("div",{ref:"previewIconGroup",staticClass:"icon-group",style:e.iconStyleObject},[e.existedInOperation("replace")?a("div",{staticClass:"icon iconfont icon-check operation-replace",class:{hovering:"replace"===e.defaultOperation},on:{click:function(t){e._replaceExistedTree(t)},mouseover:e.childHover}}):e._e(),e.existedInOperation("save2gallery")&&!e.existedInGallery()?a("div",{staticClass:"icon iconfont icon-star operation-save2gallery",class:{hovering:"save2gallery"===e.defaultOperation},on:{click:function(t){e._addTemplate2Library(t)},mouseover:e.childHover}}):e._e(),e.existedInOperation("save2gallery")&&e.existedInGallery()?a("div",{staticClass:"icon iconfont icon-shoucang operation-save2gallery",class:{hovering:"save2gallery"===e.defaultOperation},on:{click:function(t){e._addTemplate2Library(t)},mouseover:e.childHover}}):e._e(),e.existedInOperation("download")?a("div",{staticClass:"icon iconfont icon-xiazai operation-download",class:{hovering:"download"===e.defaultOperation},on:{click:function(t){e._downloadTemplate(t)},mouseover:e.childHover}}):e._e(),e.existedInOperation("add2dsllist")?a("div",{staticClass:"icon iconfont icon-tianjia operation-add2dsllist",class:{hovering:"add2dsllist"===e.defaultOperation},on:{click:function(t){e._add2DSLList(t)},mouseover:e.childHover}}):e._e(),e.existedInOperation("dsllist-remove")?a("div",{staticClass:"icon iconfont icon-iconfontshanchu operation-dsllist-remove",class:{hovering:"dsllist-remove"===e.defaultOperation},on:{click:function(t){e._removeTemplateFromDsllist(t)},mouseover:e.childHover}}):e._e(),e.existedInOperation("gallery-remove")?a("div",{staticClass:"icon iconfont icon-iconfontshanchu operation-gallery-remove",class:{hovering:"gallery-remove"===e.defaultOperation},on:{click:function(t){e._removeTemplateFromGallery(t)},mouseover:e.childHover}}):e._e()])])},tt=[];var at={name:"SinglePreviewFigure",components:{},props:{dslId:{type:String},getTreeDSLObj:{type:Function},operation:{type:Array},replaceExistedTree:{type:Function},addTemplate2Library:{type:Function},downloadTemplate:{type:Function},removeTemplateFromDsllist:{type:Function},removeTemplateFromGallery:{type:Function},add2DSLList:{type:Function},defaultOperationFunc:{type:Function}},data:function(){return{treeGId:"preview-g",treeViewPosLenObj:{},currentTreeDSLArray:[],AreaData:{},focusedTreeNodeArray:[],DURATION:1e3,iconStyleObject:{left:0,right:0},IconWidth:30,defaultOperation:null,replaceExistedTreeTip:"replace current GoTree template",addTemplate2LibraryTip:"add GoTree template to library",downloadTemplateTip:"download GoTree template",add2DSLListTip:"add GoTree template to DSLList panel",removeTemplateFromDsllistTip:"remove GoTree template from DSLList panel",removeTemplateFromGalleryTip:"remove GoTree template from gallery"}},created:function(){},mounted:function(){var e=this;setTimeout((function(){e.updateElementAttr(),e.initTreePreviewCanvas(),e.getPreViewTreeLayout(),e.adjustIconGroup2Center()}),50)},updated:function(){},watch:{changedDSLNameState:function(){this.treeUnitDSLName===this.dslId&&this.getPreViewTreeLayout()},treePreviewLayoutState:function(){this.treeUnitDSLName===this.dslId&&this.getPreViewTreeLayout()},operation:function(){this.adjustIconGroup2Center()}},computed:Object(o["a"])({},Object(u["d"])(["changedDSLNameState","treeUnitDSLName","treePreviewLayoutState"])),methods:{_replaceExistedTree:function(e){e.stopPropagation(),"undefined"!==typeof this.replaceExistedTree&&this.replaceExistedTree(this.dslId)},_addTemplate2Library:function(e){e.stopPropagation(),"undefined"!==typeof this.addTemplate2Library&&this.addTemplate2Library(this.dslId)},_downloadTemplate:function(e){e.stopPropagation(),"undefined"!==typeof this.downloadTemplate?this.downloadTemplate():this.save_as_json()},_removeTemplateFromDsllist:function(e){e.stopPropagation(),"undefined"!==typeof this.removeTemplateFromDsllist&&this.removeTemplateFromDsllist(this.dslId)},_removeTemplateFromGallery:function(e){e.stopPropagation(),"undefined"!==typeof this.removeTemplateFromGallery&&this.removeTemplateFromGallery(this.dslId)},_add2DSLList:function(e){e.stopPropagation(),"undefined"!==typeof this.add2DSLList&&this.add2DSLList(this.dslId)},childHover:function(e){e.stopPropagation()},parentMouseover:function(){this.operation.length>0&&(this.defaultOperation=this.operation[0])},parentMouseout:function(){this.defaultOperation=null},parentClick:function(){this.defaultOperationFunc(this.dslId)},existedInGallery:function(){var e=sysDatasetObj.isTemplateExisted(this.dslId);return e},existedInOperation:function(e){return-1!==this.operation.indexOf(e)},preview_hovering:function(){console.log("preview_hovering")},save_as_json:function(){var e=this.dslId,t=this.getTreeDSLObj(e),a=He(t),r="GoTree-template-"+this.dslId+".json";function n(e,t,a){var r=JSON.stringify(e),n=document.createElement("a"),i=new Blob([r],{type:a});n.href=URL.createObjectURL(i),n.download=t,n.click()}n(a,r,"text/json")},updateElementAttr:function(){this.dslPreviewCanvasHeight=this.$refs.dslPreviewCanvas.clientHeight,this.dslPreviewCanvasWidth=this.$refs.dslPreviewCanvas.clientWidth,this.dslPreviewContainerHeight=this.$refs.dslPreviewContainer.clientHeight,this.dslPreviewContainerWidth=this.$refs.dslPreviewContainer.clientWidth,this.previewIconGroupHeight=this.$refs.previewIconGroup.clientHeight},adjustIconGroup2Center:function(){var e=this.previewIconGroupHeight,t=this.IconWidth,a=this.operation.length;a>1&&(t=2*this.IconWidth);var r=this.dslPreviewContainerHeight,n=this.dslPreviewContainerWidth,i=(n-t)/2,o=(r-e)/2;this.iconStyleObject={left:i+"px",top:o+"px"}},initTreePreviewCanvas:function(){var e=this.dslPreviewCanvasHeight,t=this.dslPreviewCanvasWidth,a=.05*t,r=.05*t,n=.05*e,i=.05*e,o=t-a-r;this.dslPreviewWidth=o;var s=e-n-i;this.dslPreviewHeight=s,d3.select(this.$el).select(".tree-preview-g").attr("transform","translate("+a+","+n+")"),this.treeViewPosLenObj={x:0,y:0,width:o,height:s}},updateCurrentDSLArray:function(){for(var e=[],t=this.focusedTreeObjArray,a=sysDatasetObj.getLayoutParas(),r=a.treeIndexWithDSL,n=0;n<t.length;n++){var i=t[n],o=r[i];"undefined"===typeof o&&(o=r.default),-1===e.indexOf(o)&&e.push(o)}this.currentTreeDSLArray=e},generateTreeIndexWihDSL:function(e,t){for(var a={},r=0;r<e.length;r++){var n=e[r].data.index;a[n]=t}return a},getPreViewTreeLayout:function(){var e=this,t=sysDatasetObj.getTreeUnitDataset();if("x"in this.treeViewPosLenObj){var a=this.dslId;if("undefined"!==typeof t){var r=sysDatasetObj.computeNodeArray(t),n=e.generateTreeIndexWihDSL(r,a);this.focusedTreeNodeArray=r;var i={};if(i[a]=this.getTreeDSLObj(a),"undefined"===typeof i[a])return;var o=ve(i),s={hierarchicalData:t,treeDSLContentObj:o,treeIndexWithDSL:n};F(s).then((function(t){e.renderPreViewTree(t,o,n,r,s)}))}}},renderPreViewTree:function(e,t,a,r,n){var i=this.treeViewPosLenObj,o=p(a,t,e,r,i);this.AreaData=o;var s=this.dslPreviewWidth,l=this.dslPreviewHeight,d=ae(o,t,a,i,r),u=Object(c["a"])(d,2),h=u[0],f=u[1];h=pe(h,t,a,r),f=ge(f,o,t,a,r,s,l),this.renderTreeNode(h),this.renderTreeLink(f,n)},renderTreeLink:function(e,t){var a=this,r=a.treeGId,n=d3.select(this.$el).select("#"+r).selectAll(".link").data(e);n.enter().append("path").attr("id",(function(e,t){return"link"+e.beginid+"to"+e.endid})).attr("class",(function(e,t){return"link link-parent-"+e.beginid+" link-child-"+e.endid})).attr("d",(function(e,t){return e.pathAttr})).attr("stroke-width",(function(e,t){return e.link_width})).attr("fill","none");var i=[],o=[],s=[];n.each((function(e,t){var r=d3.select(this).attr("d");null!=r&&"undefined"!==typeof r&&i.push(r);var n=e.pathAttr;null!=n&&"undefined"!==typeof n&&o.push(n),s.push(d3.select(this).node()),d3.select(this).transition().duration(a.DURATION).attr("stroke-width",(function(e,t){return e.link_width})).attr("fill","none")})),n.exit().remove();var l=function(){n.each((function(e,t){d3.select(this).attr("d",e.pathAttr)}))};i.length>0&&o.length>0?i.length===o.length&&null!=i[0]&&null!=o[0]&&"undefined"!==typeof i[0]&&"undefined"!==typeof o[0]&&Object(re["tweenPaths"])({duration:a.DURATION,complete:l,from:i,to:o,next:function(e,t){return s[t].setAttribute("d",e)}}):l()},renderTreeNodeLabel:function(e){var t=this.treeGId,a=d3.select(this.$el).select("#"+t).selectAll(".node-label").data(e,(function(e,t){return e.id}));a.enter().append("text").attr("class","node-label").attr("id",(function(e){return"node-label-"+e.id})).attr("transform",(function(e){return"translate("+e.labelPos.x+","+e.labelPos.y+")rotate("+e.rotation+")"})).style("text-anchor",(function(e){return e.textAnchor})).style("alignment-baseline","middle").style("font-size",(function(e){return e.fontSize})).text((function(e,t){if("undefined"!==typeof e.labelValue)return e.labelValue.length>2?e.labelValue.substring(0,1)+" .":e.labelValue})),a.transition().duration(self.DURATION).attr("transform",(function(e){return"translate("+e.labelPos.x+","+e.labelPos.y+")rotate("+e.rotation+")"})).style("text-anchor",(function(e){return e.textAnchor})).style("font-size",(function(e){return e.fontSize})).text((function(e,t){if("undefined"!==typeof e.labelValue)return e.labelValue.length>2?e.labelValue.substring(0,1)+" .":e.labelValue})),a.exit().remove()},renderTreeNode:function(e){for(var t=this,a=t.treeGId,r=1,n=!1,i=0;i<e.length;i++)r<e[i].depth&&(r=e[i].depth,console.log("areaDataArray[i].element",e[i].element)),-1!==e[i].element.indexOf("NaN")&&(n=!0);if(!n){var o=d3.select(this.$el).select("#"+a).selectAll(".lineartree-node").data(e,(function(e,t){return e.id}));o.enter().append("path").attr("class","lineartree-node").attr("id",(function(e,t){return"rootnode"+e.id})).attr("d",(function(e,t){return e.element})).attr("fill",(function(e){return e.node_color})).style("stroke-width",(function(e,t){return e.link_width})).style("opacity",1);var s=[],l=[],d=[];o.each((function(e,a){var r=e.element,n=d3.select(this).attr("d");d.push(d3.select(this).node()),s.push(n),l.push(r),d3.select(this).transition().duration(t.DURATION).attr("fill",(function(e){return e.node_color})).style("stroke-width",(function(e,t){return e.link_width})).style("opacity",1)}));var c=function(){o.each((function(e,t){var a=e.element;d3.select(this).attr("d",a)}))};s.length>0&&l.length>0?s.length===l.length&&null!=s[0]&&null!=l[0]&&"undefined"!==typeof s[0]&&"undefined"!==typeof l[0]&&Object(re["tweenPaths"])({duration:t.DURATION,complete:c,from:s,to:l,next:function(e,t){return d[t].setAttribute("d",e)}}):c(),o.exit().remove()}}}},rt=at,nt=(a("d701"),a("5e71"),Object(ce["a"])(rt,et,tt,!1,null,"e691978c",null)),it=nt.exports,ot={name:"DataDialog",components:{SinglePreviewFigure:it},data:function(){return{systemTemplateOperation:["add2dsllist"],rootSystemTemplateOperation:["add2dsllist","gallery-remove"],userTemplateOperation:["add2dsllist","gallery-remove"],systemTreeTemplateArray:[],userTreeTemplateArray:[],templateNameDialogVisible:!1,realTemplateName:"gotree",exampleName:"gotree",templateNameWarningHint:""}},watch:{treedslDialogUpdate:function(){this.updateSystemTreeTemplateArray(),this.updateUserTreeTemplateArray()}},props:{treedslDialogUpdate:{type:Number},updateCurrentTreeDSLIndex:{type:Function}},created:function(){},beforeMount:function(){ze();this.updateSystemTreeTemplateArray(),this.updateUserTreeTemplateArray()},mounted:function(){console.log("mounted")},computed:Object(o["a"])({},Object(u["d"])(["selectedDSLArray","userInfoName"])),methods:{addNewTreeDSL:function(){console.log("add new tree dsl")},cancelImportDSLTemplate:function(){this.templateNameDialogVisible=!1},confirmImportDSLTemplate:function(){this.templateNameDialogVisible=!1;var e=this.realTemplateName,t=this.exampleName;this.selectedDSLArray.push(e);var a=sysDatasetObj.getOriginalTreeTemplate(t);a.Name=e,sysDatasetObj.updateSingleSelectedDSLObject(e,a),this.promptMessage("success",e+" has been added in DSLlist view"),this.$cookies.set("selected-dsl-array",this.selectedDSLArray)},getFile:function(){console.log("upload file ok")},getTreeDSLObj:function(e){var t=sysDatasetObj.getOriginalTreeTemplate(e);return t},changeGoTreeName:function(){var e=this.selectedDSLArray,t=this.realTemplateName;-1!==e.indexOf(t)?this.templateNameWarningHint="The template name has been used.":this.templateNameWarningHint=""},removeTemplateFromGallery:function(e){var t=sysDatasetObj.removeOriginalTreeTemplate(e);this.removeOriginalTreeTemplate(e),"Login"!==t.username&&_e(t),this.updateUserTreeTemplateArray()},updateSystemTreeTemplateArray:function(){this.systemTreeTemplateArray=sysDatasetObj.getSystemTreeTemplateArray(),console.log("systemTreeTemplateArray",this.systemTreeTemplateArray)},updateUserTreeTemplateArray:function(){var e=this.userTreeTemplateArray,t=sysDatasetObj.getUserTreeTemplateArray(),a=this.concatMerge(t,e);this.userTreeTemplateArray=a},removeOriginalTreeTemplate:function(e){for(var t=this.userTreeTemplateArray,a=0;a<t.length;a++)t[a].treename===e&&t.splice(a,1);for(var r=this.systemTreeTemplateArray,n=0;n<r.length;n++)r[n].treename===e&&r.splice(n,1)},initExampleArray:function(e){for(var t=[],a=0;a<e.length;a++){var r=e[a],n={name:r,styleObject:{backgroundImage:"url(examples/"+r+".png)"}};t.push(n)}return t},selectTreeDSL:function(e){e=+e,this.updateCurrentTreeDSLIndex(e)},promptMessage:function(e,t){this.$message({type:e,message:t})},getTreeDSLName:function(e,t){for(var a=-1,r=0;r<t.length;r++){var n=t[r];if(-1!==n.indexOf(e)){var i=n.replace(e,"");i=""===i?0:+i,isNaN(i)||a<i&&(a=+i)}}var o=e;return a>-1&&(o=e+(+a+1)),o},getTreeTemplateInfo:function(e,t,a){var r=(new Date).toISOString().split("T")[0];return{treename:t,username:a,template:e,date:r}},handleTemplateSuccess:function(e,t){console.log("upload success")},addTreeTemplateCallback:function(e){this.promptMessage(e.type,e.message)},beforeTemplateUpload:function(e){var t=this,a="application/json"===e.type,r=e.size/1024/1024<2,n=sysDatasetObj.getTreeTemplateArray(),i=this.userTreeTemplateArray,o=e.name.replace(".json",""),s=n.findIndex((function(e){return e.treename===o})),l=i.findIndex((function(e){return e.Name===o})),d=-1===s&&-1===l;if(a)if(r){if(d){var c=new FileReader;return c.readAsText(e,"utf-8"),c.onload=function(a){var r=t.userInfoName,n=JSON.parse(this.result),i=e.name.replace(".json","");n.Name=i;var o=t.getTreeTemplateInfo(n,i,r);sysDatasetObj.addTreeTemplateArray([o]),t.userTreeTemplateArray.push(o),"Login"!==t.userInfoName&&Ee(o,t.addTreeTemplateCallback)},a&&r&&d}this.$message.error("The file name is existed!")}else this.$message.error("The file size can not exceed 2MB!");else this.$message.error("The uploaded file must be JSON format!")},concatMerge:function(e,t){var a=e.concat(t),r=[],n=!0,i=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){for(var d=s.value,c=!0,u=0,h=r;u<h.length;u++){var f=h[u];d.treename===f.treename&&(c=!1)}c&&r.push(d)}}catch(p){i=!0,o=p}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return r}}},st=ot,lt=(a("f9ee"),Object(ce["a"])(st,Je,$e,!1,null,"3fa8a381",null)),dt=lt.exports;function ct(e){return ut.apply(this,arguments)}function ut(){return ut=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d3.json("hierarchicalData/"+t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)}))),ut.apply(this,arguments)}var ht,ft=a("ba5a"),pt={name:"app",components:{TreeCanvas:Ae,OriginalDataView:he,DataDialog:Ie,ExportDialog:Ge,TreedslDialog:dt},data:function(){return{appName:"Tree Illustrator",initTreeDataName:null,treeTemplateObj:null,activeIndex:null,componentKey:0,dataDialogVisible:!1,treedslDialogVisible:!1,exportDialogVisible:!1,loading:!0,loadingData:!0,loadingView:!0,OPEN_PREVIEW_PANEL_DURATION:1e3,treeCanvasKey:0,systemUserName:"root",userInfoDialogKey:0,dataDialogKey:0,treedslDialogUpdate:1,dslNameIndex:0,maxDslAmountIndex:1e3}},created:function(){},beforeMount:function(){var e=this,t=this.maxDslAmountIndex;window.sysDatasetObj=new Qe;var a=$.Deferred(),r=$.Deferred(),n=$.Deferred();$.Deferred(),$.Deferred();$.when(a,r,n).then(Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.loading=!1,e.loadingData=!1;case 2:if(!(e.dslNameIndex<t)){a.next=9;break}return a.next=5,h(e.dslNameIndex);case 5:a.sent,e.dslNameIndex=e.dslNameIndex+1,a.next=2;break;case 9:console.log("this will print last");case 10:case"end":return a.stop()}}),a)}))));var i="treeunit.json";ct(i).then((function(e){sysDatasetObj.updateTreeUnitDataset(e),a.resolve()}));var o="root",l="flare-vis.json";this.initTreeDataName=l,ct(l).then((function(t){var a=Se(t,o,l);sysDatasetObj.addTreeDataset(a),e.updateSelectedHierarchicalData(l),r.resolve()}));for(var d=[],c=e.dslNameIndex;c<t;c++)d.push(c+"");var u="space-align/";function h(t){return new Promise((function(a,r){setTimeout((function(){var r=sysDatasetObj.getLayoutParas(),n=sysDatasetObj.getNodeArrayWithValueObj(),i=e.computeAllNodeTreeIndexWithDSL(n,t);r.treeIndexWithDSL=i,r.treeDSLContentObj=e.getTreeDSLContentObj(i),e.UPDATE_TREE_CANVAS_LAYOUT_STATE(),e.loadingView=!1,a(t)}),1e3)}))}qe(d,u).then((function(e){var t=[];for(var a in e)t.push({treename:a,username:o,template:e[a]});sysDatasetObj.addTreeTemplateArray(t),sysDatasetObj.initSelectedDSLObject(d),n.resolve()}))},mounted:function(){this.initializeLSCG()},computed:Object(o["a"])({},Object(u["d"])(["userInfoName","treeViewUpdate","currentTree","treeDataViewFormat","treeDslOption","previewTreeObj","selectedDataset","focusedTreeObjArray"])),methods:Object(o["a"])({iconClass:function(e){return"icon-"+e},onShow:function(){},updateCurrentTreeDSLIndex:function(e){this.dslNameIndex=e},computeAllNodeTreeIndexWithDSL:function(e,t){var a={};for(var r in e)a[r]=t;return a},setTreeDSLContent_Render_Download:function(e,t){var a=this;return new Promise((function(r,n){a.treeTemplateObj={templates:[{query:{attribute:"depth",criteria:0},recursive:!0,dslname:e+""}]};var i=a.computeTreeIndexWithDSL();t.treeIndexWithDSL=i,t.treeDSLContentObj=a.getTreeDSLContentObj(i),console.log("layoutParas",t),setTimeout((function(){a.UPDATE_TREE_CANVAS_LAYOUT_STATE(),a.loadingView=!1}),1e3)}))},handleClickDataIcon:function(){this.dataDialogVisible=!0,this.dataDialogKey=(this.dataDialogKey+1)%2},handleClickTemplateIcon:function(){this.treedslDialogVisible=!0,this.treedslDialogUpdate=(this.treedslDialogUpdate+1)%2},promptMessage:function(e,t){this.$message({type:e,message:t})},getTreeDSLContentObj:function(e){var t={};for(var a in e){var r=e[a];t[r]=sysDatasetObj.getTreeDSLObject(r)}return t},closeDataView:function(){var e=this,t=e.OPEN_PREVIEW_PANEL_DURATION,a=$("#original-data-view").width();$("#treecanvas-content-view").animate({left:"-="+a},t,(function(){e.treeCanvasKey=(e.treeCanvasKey+1)%2}))},openDataView:function(){var e=this,t=e.OPEN_PREVIEW_PANEL_DURATION,a=$("#original-data-view").width();$("#treecanvas-content-view").animate({left:"+="+a},t,(function(){e.treeCanvasKey=(e.treeCanvasKey+1)%2}))},updateSelectedTreeDateName:function(e){var t=this;t.updateSelectedHierarchicalData(e)},closeDataDialog:function(){this.dataDialogVisible=!1},updateSelectedHierarchicalData:function(e){var t=this;sysDatasetObj.updateDataset(e);var a=sysDatasetObj.getAllTreeObjIdArray(),r=sysDatasetObj.extractAttrArray();t.UPDATE_ATTR_OBJ_ARRAY(r),t.UPDATE_FOCUS_TREE_OBJ_ARRAY(a),t.UPDATE_SELECTED_DATASET(e),t.updateLayoutParas();sysDatasetObj.getLayoutParas();this.UPDATE_TREE_CANVAS_LAYOUT_STATE()},updateLayoutParas:function(){var e=sysDatasetObj.getLayoutParas(),t=e.treeIndexWithDSL,a=e.treeDSLContentObj;if("undefined"!==typeof t&&"undefined"!==typeof a){for(var r=t["index-0"],n=sysDatasetObj.getAllTreeObjIdArray(),i=0;i<n.length;i++){var o=n[i];"undefined"===typeof t[o]&&(t[o]=r)}for(var s in t)-1===n.indexOf(s)&&delete t[s]}},computeTreeIndexWithDSL:function(){console.log("this.treeTemplateObj",this.treeTemplateObj);for(var e=this.treeTemplateObj.templates,t=sysDatasetObj.getNodeArrayWithValueObj(),a={},r=0;r<e.length;r++){var n=e[r],i=n.query;console.log("queryObject",i,"nodeArrayWithValueObj",t);var o=this.getQueryNodeIdArray(i,t);console.log("nodeIdArray",o);for(var s=n.recursive,l=this.getFocusedTreeObjIdArray(o,s,t),d=n.dslname,c=0;c<l.length;c++)a[l[c]]=d}return a},getQueryNodeIdArray:function(e,t){var a=e.attribute,r=e.criteria,n=[];switch(r){case"odd":for(var i in t)t[i][a]%2===1&&n.push(t[i].index);break;case"even":for(var o in t)t[o][a]%2===0&&n.push(t[o].index);break;default:for(var s in t)t[s][a]===r&&n.push(t[s].index);break}return n},getFocusedTreeObjIdArray:function(e,t,a){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=[];"true"===t||!0===t?o=l(i):"false"!==t&&!1!==t||(o=[i]);for(var s=0;s<o.length;s++)-1===r.indexOf(o[s])&&r.push(o[s])}return r;function l(e){var t=[],r=[e];while(void 0!==e){if("children"in a[e])for(var n=0;n<a[e].children.length;n++){var i=a[e].children[n].index;t.push(i),r.push(i)}e=t.shift()}return r}},save_as_png:function(){var e=this.getDownloadFileName(),t="tree-dsl-svg-canvas",a="tree-dsl-canvas",r=d3.select(document.getElementById(t)),n=r.select("#"+a);n.selectAll(".mark-line").attr("display","none"),n.select(".tree-g").selectAll(".resize-circle-g").attr("display","none"),ke.a.saveSvgAsPng(r.node(),e).then((function(){n.selectAll(".mark-line").attr("display",null),n.select(".tree-g").selectAll(".resize-circle-g").attr("display",null)}))},getDownloadFileName:function(){var e=this.getCurrentDSLName(),t=this.selectedDataset.replace(".json","");return"GoTree-"+t+e},getCurrentDSLName:function(){var e=[],t=sysDatasetObj.getLayoutParas(),a=this.focusedTreeObjArray,r=t.treeIndexWithDSL;for(var n in r)if(-1!==a.indexOf(n)){var i=r[n];-1===e.indexOf(i)&&e.push(i)}var o="";this.currentTreeDSLArray=e;for(var s=0;s<e.length;s++)o=o+"-"+e[s];return o},initializeLSCG:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ft["initialize"]().then((function(){}));case 2:window.lscgSolver=ft;case 3:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},Object(u["c"])(["UPDATE_SELECTED_DATASET","UPDATE_ATTR_OBJ_ARRAY","UPDATE_FOCUS_TREE_OBJ_ARRAY","UPDATE_TREE_CANVAS_LAYOUT_STATE"]))},gt=pt,vt=(a("7c55"),a("cb3a"),Object(ce["a"])(gt,n,i,!1,null,"7b44262f",null)),yt=vt.exports;a("2caf");function mt(e){return e&&"object"===Object(fe["a"])(e)&&!Array.isArray(e)}function Tt(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];if(!a.length)return e;var n=a.shift();if(mt(e)&&mt(n))for(var i in n)mt(n[i])?(e[i]||Object.assign(e,Object(Ke["a"])({},i,{})),Tt(e[i],n[i])):Object.assign(e,Object(Ke["a"])({},i,n[i]));return Tt.apply(void 0,[e].concat(a))}Le.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",r["default"].use(u["a"]);var At=new u["a"].Store({state:{attrObjArray:[],previewTreeObj:null,selectedPreviewNodeId:null,viewSelectionMode:"Sibling",viewSelectionMode2:"Subtree",focusedTreeObjArray:[],selectedDataset:null,treeUnitDSLArray:[],treeUnitDSLName:null,selectedDSLArray:[],changedDSLNameState:0,treeCanvasLayoutState:0,treeUnitLayoutState:0,treePreviewLayoutState:0,selectParaName:null,dslListSelectedDSLName:null,dslListSelectedDSLState:0,manipulateParaValue:null,manipulateValue:0,manipulatePara:"",assignNodeQuery:"index",assignRecursiveMode:"true",assignDSLName:"",assembleMode:"bottom-up",assembleSubtreeWidth:"adaptive",assembleSubtreeHeight:"adaptive",currentTreeDSLArray:[],userInfoName:"Login",userInfoObj:null,hierarchicalData:null,originalHierarchicalDataObj:null,nodeArray:[],originalNodeArray:[],hierarchicalDSL:{},focusedDSLObj:{},treeDSLArray:[],treeDSLArrayKey:0,hoveringDSLItem:null,treeViewUpdate:0,currentTree:"test",treeDSLViewFormat:"block",treeDataViewFormat:"tree",treeDataViewSetting:!1,dataDisplayMode:"tree",selectionMode:"Subtree",layouts:[],layoutParas:{},treeUnitLayout:[],partitionValue:0,partitionDataObjDic:{},drawerViewSelectionState:"template",focusedDSLObjIndex:0,dragComponentState:"DRAG-END",rootLayoutComponent:null,subtreeLayoutComponent:null,nodeComponent:null,linkComponent:null,coordComponent:null,hoverParam:"",hoverParamAxis:""},mutations:(ht={},Object(Ke["a"])(ht,"UPDATE_USER_INFO_OBJ",(function(e,t){e.userInfoObj=t})),Object(Ke["a"])(ht,"UPDATE_USER_INFO_NAME",(function(e,t){e.userInfoName=t})),Object(Ke["a"])(ht,"UPDATE_CURRENT_TREE_DSL_ARRAY",(function(e,t){e.currentTreeDSLArray=t})),Object(Ke["a"])(ht,"UPDATE_ASSEMBLE_SUBTREE_HEIGHT",(function(e,t){e.assembleSubtreeHeight=t})),Object(Ke["a"])(ht,"UPDATE_ASSEMBLE_SUBTREE_WIDTH",(function(e,t){e.assembleSubtreeWidth=t})),Object(Ke["a"])(ht,"UPDATE_ASSEMBLE_MODE",(function(e,t){e.assembleMode=t})),Object(Ke["a"])(ht,"UPDATE_ASSIGN_DSL_NAME",(function(e,t){e.assignDSLName=t})),Object(Ke["a"])(ht,"UPDATE_ASSIGN_NODE_QUERY",(function(e,t){e.assignNodeQuery=t})),Object(Ke["a"])(ht,"UPDATE_ASSIGN_RECURSIVE_MODE",(function(e,t){e.assignRecursiveMode=t})),Object(Ke["a"])(ht,"UPDATE_ATTR_OBJ_ARRAY",(function(e,t){e.attrObjArray=t})),Object(Ke["a"])(ht,"UPDATE_VIEW_SELECTION_MODE",(function(e,t){e.viewSelectionMode=t})),Object(Ke["a"])(ht,"UPDATE_VIEW_SELECTION_MODE2",(function(e,t){e.viewSelectionMode2=t})),Object(Ke["a"])(ht,"UPDATE_PREVIEW_TREE_OBJ",(function(e,t){e.previewTreeObj=t})),Object(Ke["a"])(ht,"UPDATE_FOCUS_TREE_OBJ_ARRAY",(function(e,t){e.focusedTreeObjArray=t})),Object(Ke["a"])(ht,"UPDATE_SELECTED_PREVIEW_NODE_ID",(function(e,t){e.selectedPreviewNodeId=t})),Object(Ke["a"])(ht,"UPDATE_SELECTED_DATASET",(function(e,t){e.selectedDataset=t})),Object(Ke["a"])(ht,"UPDATE_TREEUNIT_DSL_ARRAY",(function(e,t){e.treeUnitDSLArray=t})),Object(Ke["a"])(ht,"UPDATE_TREEUNIT_DSL_NAME",(function(e,t){e.treeUnitDSLName=t})),Object(Ke["a"])(ht,"UPDATE_CHANGED_DSL_NAME_STATE",(function(e,t){e.changedDSLNameState=(e.changedDSLNameState+1)%2})),Object(Ke["a"])(ht,"UPDATE_TREE_CANVAS_LAYOUT_STATE",(function(e,t){e.treeCanvasLayoutState=(e.treeCanvasLayoutState+1)%2})),Object(Ke["a"])(ht,"UPDATE_TREE_UNIT_LAYOUT_STATE",(function(e,t){e.treeUnitLayoutState=(e.treeUnitLayoutState+1)%2})),Object(Ke["a"])(ht,"UPDATE_TREE_PREVIEW_LAYOUT_STATE",(function(e,t){e.treePreviewLayoutState=(e.treePreviewLayoutState+1)%2})),Object(Ke["a"])(ht,"UPDATE_LAYOUTS",(function(e,t){e.layouts=t})),Object(Ke["a"])(ht,"UPDATE_TREE_UNIT_LAYOUTS",(function(e,t){e.treeUnitLayout=t})),Object(Ke["a"])(ht,"UPDATE_SELECT_PARA_NAME",(function(e,t){e.selectParaName=t})),Object(Ke["a"])(ht,"UPDATE_HOVER_PARAM",(function(e,t){e.hoverParam=t.param,e.hoverParamAxis=t.axis})),Object(Ke["a"])(ht,"UPDATE_DSLLIST_SELECTED_DSL_NAME",(function(e,t){e.dslListSelectedDSLName=t})),Object(Ke["a"])(ht,"UPDATE_DSLLIST_SELECTED_DSL_STATE",(function(e){e.dslListSelectedDSLState=(e.dslListSelectedDSLState+1)%2})),Object(Ke["a"])(ht,"MANIPULATE_PARA",(function(e,t){e.manipulatePara=t})),Object(Ke["a"])(ht,"MANIPULATE_VALUE",(function(e,t){e.manipulateValue=t})),Object(Ke["a"])(ht,"UPDATE_HIERARCHICAL_DATA",(function(e,t){e.hierarchicalData=t})),Object(Ke["a"])(ht,"UPDATE_SELECTED_DSL_ARRAY",(function(e,t){e.selectedDSLArray=t})),Object(Ke["a"])(ht,"UPDATE_ORIGINAL_HIERARCHICAL_DATA",(function(e,t){e.originalHierarchicalDataObj=t})),Object(Ke["a"])(ht,"UPDATE_NODE_ARRAY",(function(e,t){e.nodeArray=t})),Object(Ke["a"])(ht,"UPDATE_ORIGINAL_NODE_ARRAY",(function(e,t){e.originalNodeArray=t})),Object(Ke["a"])(ht,"UPDATE_HIERARCHICAL_DSL",(function(e,t){e.hierarchicalDSL=t})),Object(Ke["a"])(ht,"UPDATE_CURRENT_TREE",(function(e,t){e.currentTree=t})),Object(Ke["a"])(ht,"UPDATE_DSL_VIEW_FORMAT",(function(e,t){e.treeDSLViewFormat=t})),Object(Ke["a"])(ht,"UPDATE_DATA_VIEW_FORMAT",(function(e,t){e.treeDataViewFormat=t})),Object(Ke["a"])(ht,"UPDATE_DATA_VIEW_SETTING",(function(e,t){e.treeDataViewSetting=t})),Object(Ke["a"])(ht,"UPDATE_TREE_DSL_ARRAY",(function(e,t){e.treeDSLArray=t})),Object(Ke["a"])(ht,"UPDATE_TREE_DSL_ARRAY_KEY",(function(e,t){e.treeDSLArrayKey=t})),Object(Ke["a"])(ht,"UPDATE_DATA_DISPLAY_MODE",(function(e,t){e.dataDisplayMode=t})),Object(Ke["a"])(ht,"UPDATE_SELECTION_MODE",(function(e,t){e.selectionMode=t})),Object(Ke["a"])(ht,"UPDATE_HOVERING_DSL_ITEM",(function(e,t){e.hoveringDSLItem=t})),Object(Ke["a"])(ht,"UPDATE_FOCUSED_DSL_OBJ",(function(e,t){e.focusedDSLObj=t})),Object(Ke["a"])(ht,"UPDATE_LAYOUT_PARAS",(function(e,t){e.layoutParas=t})),Object(Ke["a"])(ht,"UPDATE_PARTITION_VALUE",(function(e,t){e.partitionValue=t})),Object(Ke["a"])(ht,"UPDATE_PARTITION_DATA_OBJ_DIC",(function(e,t){e.partitionDataObjDic=t})),Object(Ke["a"])(ht,"UPDATA_DRAWER_VIEW_SELECTION_STATE",(function(e,t){e.drawerViewSelectionState=t})),Object(Ke["a"])(ht,"UPDATE_FOCUSED_DSL_OBJ_INDEX",(function(e,t){e.focusedDSLObjIndex=t})),Object(Ke["a"])(ht,"UPDATE_DRAG_COMPONENT_STATE",(function(e,t){e.dragComponentState=t})),Object(Ke["a"])(ht,"UPDATE_ROOT_LAYOUT",(function(e,t){e.rootLayoutComponent=t})),Object(Ke["a"])(ht,"UPDATE_SUBTREE_LAYOUT",(function(e,t){e.subtreeLayoutComponent=t})),Object(Ke["a"])(ht,"UPDATE_NODE",(function(e,t){e.nodeComponent=t})),Object(Ke["a"])(ht,"UPDATE_LINK",(function(e,t){e.linkComponent=t})),Object(Ke["a"])(ht,"UPDATE_COORD",(function(e,t){e.coordComponent=t})),ht),actions:{updateTreeDSL:function(e,t){e.commit;for(var a=e.state,r=t.treeDSLContent,n=t.editorId,i=0;i<a.treeDSLArray.length;i++)a.treeDSLArray[i].editorId===n&&(a.treeDSLArray[i].content=r)},updateTreeUnitLayout:function(e,t){var a=e.commit;a("UPDATE_TREE_UNIT_LAYOUTS",t)},setDSLComponent:function(e,t){var a=e.commit,r=e.state;if(0===r.treeUnitDSLArray.length){var n={name:"untitled0"};n.dslObj=l(n.name),n.dslObj=Tt(n.dslObj,t),sysDatasetObj.updateSelectedDSLObject(n.name,n.dslObj),r.selectedDSLArray.push(n.name),sysDatasetObj.updateTreeDSLContentObject(n.name,n.dslObj),r.treeUnitDSLArray.push(n),r.treeUnitDSLArray=JSON.parse(JSON.stringify(r.treeUnitDSLArray)),setTimeout((function(){if(r.treeUnitDSLArray.length>=1){var e=r.treeUnitDSLArray[0].name;a("UPDATE_DSLLIST_SELECTED_DSL_NAME",e),a("UPDATE_TREEUNIT_DSL_NAME",e)}a("UPDATE_TREE_UNIT_LAYOUT_STATE"),sysDatasetObj.updateTreeDSLContentObject(n.name,n.dslObj),a("UPDATE_TREE_CANVAS_LAYOUT_STATE"),sysDatasetObj.updateSelectedDSLObject(n.name,n.dslObj),a("UPDATE_TREE_PREVIEW_LAYOUT_STATE")}),200)}else for(var i=0;i<r.treeUnitDSLArray.length;i++){var o=r.treeUnitDSLArray[i];if(o.name===r.treeUnitDSLName){var s=Tt(o.dslObj,t);console.log("existingTreeDSLObj",s),o.dslObj=s,a("UPDATE_TREE_UNIT_LAYOUT_STATE"),sysDatasetObj.updateTreeDSLContentObject(r.treeUnitDSLName,s),a("UPDATE_TREE_CANVAS_LAYOUT_STATE"),sysDatasetObj.updateSelectedDSLObject(r.treeUnitDSLName,s),a("UPDATE_TREE_PREVIEW_LAYOUT_STATE")}}function l(e){var t={};return y(t),t.Name=e,t}},removeDSLComponent:function(e,t){for(var a=e.commit,r=e.state,n=0;n<r.treeUnitDSLArray.length;n++){var i=r.treeUnitDSLArray[n];if(i.name===r.treeUnitDSLName){var o=i.dslObj;"Root"===t?(o.Layout.X.Root.Relation="Undefined",o.Layout.Y.Root.Relation="Undefined"):"Subtree"===t?(o.Layout.X.Subtree.Relation="Undefined",o.Layout.Y.Subtree.Relation="Undefined"):"Node"===t?o.Element.Node="hidden":"Link"===t?o.Element.Link="hidden":"CoordinateSystem"===t&&delete o.CoordinateSystem,sysDatasetObj.updateTreeDSLContentObject(r.treeUnitDSLName,o),a("UPDATE_TREE_CANVAS_LAYOUT_STATE"),sysDatasetObj.updateSelectedDSLObject(r.treeUnitDSLName,o),a("UPDATE_TREE_PREVIEW_LAYOUT_STATE")}}r.treeUnitDSLArray=JSON.parse(JSON.stringify(r.treeUnitDSLArray)),a("UPDATE_TREE_UNIT_LAYOUT_STATE")}}}),Dt=a("5c96"),bt=a.n(Dt),St=(a("0fae"),a("a7fe")),xt=a.n(St),Ot=a("2b27"),Lt=a.n(Ot),Pt=a("5698"),Rt=a("1157");a("a342");r["default"].use(bt.a),window.baseURL="",Le.a.defaults.baseURL="http://go-tree.info/api",window.baseURL="http://go-tree.info/api",r["default"].use(xt.a,Le.a),r["default"].use(Lt.a),r["default"].config.productionTip=!1,window.d3=Pt,window.$=Rt,window.exports={},new r["default"]({store:At,render:function(e){return e(yt)}}).$mount("#app")},5831:function(e,t,a){},"5e71":function(e,t,a){"use strict";var r=a("b5f7"),n=a.n(r);n.a},"71b4":function(e,t,a){"use strict";var r=a("1d5a"),n=a.n(r);n.a},"735c":function(e,t,a){"use strict";var r=a("52ef"),n=a.n(r);n.a},"760b":function(e,t,a){},"7c55":function(e,t,a){"use strict";var r=a("2464"),n=a.n(r);n.a},"7d82":function(e,t,a){"use strict";var r=a("760b"),n=a.n(r);n.a},"89e5":function(e,t,a){"use strict";var r=a("55a2"),n=a.n(r);n.a},"8a8c":function(e,t,a){"use strict";var r=a("103b"),n=a.n(r);n.a},a037:function(e,t,a){},a165:function(e,t,a){"use strict";var r=a("23a7"),n=a.n(r);n.a},a342:function(e,t,a){},a70f:function(e,t,a){"use strict";var r=a("c415"),n=a.n(r);n.a},b5f7:function(e,t,a){},c383:function(e,t,a){},c415:function(e,t,a){},cb3a:function(e,t,a){"use strict";var r=a("15d9"),n=a.n(r);n.a},cd36:function(e,t,a){"use strict";var r=a("2766"),n=a.n(r);n.a},d701:function(e,t,a){"use strict";var r=a("c383"),n=a.n(r);n.a},f9ee:function(e,t,a){"use strict";var r=a("a037"),n=a.n(r);n.a}});